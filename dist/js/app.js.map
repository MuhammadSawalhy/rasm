{"version":3,"file":"app.js","sources":["../../src/js/PLOTTO/Errors/ExistBefore.js","../../src/js/PLOTTO/Errors/UndefError.js","../../src/js/PLOTTO/global.js","../../src/js/PLOTTO/GraphChildren/GraphChild.js","../../src/js/PLOTTO/Canvas.js","../../src/js/PLOTTO/drawing/drawing.js","../../src/js/PLOTTO/GraphChildren/functions/Xfunction.js","../../src/js/PLOTTO/GraphChildren/Point.js","../../src/js/PLOTTO/GraphChildren/EvalExpr.js","../../src/js/PLOTTO/GraphChildren/Constant.js","../../src/js/PLOTTO/GraphChildren/Func.js","../../src/js/PLOTTO/GraphChildren/Empty.js","../../src/js/PLOTTO/GraphChildren/Slider.js","../../src/js/app/ChildControl.js","../../src/js/app/global.js","../../src/js/PLOTTO/GraphSetting/Transform.js","../../src/js/PLOTTO/GraphSetting/CoorManager.js","../../src/js/PLOTTO/GraphSetting/GraphSettings.js","../../src/js/PLOTTO/Coordinates.js","../../src/js/PLOTTO/Sketch.js","../../src/js/app/events/canvasEvents.js","../../src/js/app/events/index.js","../../src/js/app/events/toolsEvents.js","../../src/js/app/keypad/index.js","../../src/js/app/keypad/events.js","../../src/js/app/app.js"],"sourcesContent":["export default class ExistBefore extends Error{\r\n   constructor(id) {\r\n      super('\"' + id + '\" has been defined before.');\r\n      this.id = id;\r\n   }\r\n}","export default class UndefError extends Error{\r\n   constructor(undef) {\r\n      super(\"\");\r\n      this.undef = undef;\r\n   }\r\n}","import { UndefError } from './Errors/index.js';\r\nexport function generateName() {\r\n   return (Date.now() + generateName.randomNameNum++).toString(36);\r\n}\r\ngenerateName.randomNameNum = 0;\r\n\r\n// let mathFunc = {\r\n//    sin: x => Math.sin(x),\r\n//    cos: x => Math.cos(x),\r\n//    tan: x => Math.tan(x),\r\n//    asin: x => Math.asin(x),\r\n//    acos: x => Math.acos(x),\r\n//    atan: x => Math.atan(x),\r\n//    exp: x => Math.exp(x),\r\n//    ln: x => Math.log(x),\r\n//    log: function (x) {\r\n//       let base = arguments[1] || 10;\r\n//       return Math.log10(x) / Math.log(base);\r\n//    },\r\n//    sqrt: x => Math.sqrt(x),\r\n//    max: (...values) => Math.max(...values),\r\n//    min: (...values) => Math.min(...values),\r\n//    round: x => Math.round(x),\r\n//    abs: x => Math.abs(x),\r\n//    floor: x => Math.floor(x),\r\n//    ceil: x => Math.ceil(x),\r\n// };\r\n\r\nlet mathFunc = {\r\n   log: function (x, base = 10) {\r\n      return Math.log10(x) / Math.log10(base);\r\n   },\r\n   ln: x => Math.log(x, Math.E),\r\n\r\n   sec: x => 1 / Math.cos(x),\r\n   csc: x => 1 / Math.sin(x),\r\n   cot: x => 1 / Math.tan(x),\r\n   asec: x => Math.acos(1/x),\r\n   acsc: x => Math.asin(1/x),\r\n   acot: x => Math.atan(1/x),\r\n\r\n   sinh: x => (Math.exp(x) - Math.exp(-x)) / 2,\r\n   cosh: x => (Math.exp(x) + Math.exp(-x)) / 2,\r\n   tanh: x => Math.sinh(x) / Math.cosh(-x),\r\n   asinh: x => Math.ln(x + Math.sqrt(x ** 2 + 1)),\r\n   acosh: x => Math.ln(x + Math.sqrt(x ** 2 - 1)),\r\n   atanh: x => 0.5 * Math.ln((1 + x)/(1 - x)),\r\n\r\n   sech: x => 1 / Math.cosh(x),\r\n   csch: x => 1 / Math.sinh(x),\r\n   coth: x => 1 / Math.tanh(x),\r\n   asech: x => Math.acosh(1 / x),\r\n   acsch: x => Math.asinh(1 / x),\r\n   acoth: x => Math.atanh(1 / x),\r\n\r\n   fact: x => (x % 1 !== 0 || x < 0) ? NaN : Math.__fact(x), \r\n   __fact: x => x === 0 ? 1 : (x * Math.__fact(x - 1)),\r\n\r\n   gcd: (...values)=>{\r\n      let gcd_ = Math.abs(values[0]);\r\n      let a = Math.abs(values[1]);\r\n      if (gcd_ % 1 != 0 || a % 1 != 0)\r\n         return NaN;\r\n      gcd_ = a > gcd_ ? Math.gcd2(a, gcd_) : Math.gcd2(gcd_, a);\r\n\r\n      for (let i = 2; i < values.length; i++) {\r\n         a = Math.abs(values[i]);\r\n         if (a % 1 != 0)\r\n            return NaN;\r\n         gcd_ = a > gcd_ ? Math.gcd2(a, gcd_) : Math.gcd2(gcd_, a);\r\n      }\r\n\r\n      return gcd_;\r\n   },\r\n   gcd2(a, b) {\r\n      if (b == 0)\r\n         return a;\r\n      return Math.gcd(b, a % b);\r\n   },\r\n   lcm: (...values) => {\r\n      let product = 1;\r\n      let a;\r\n      for (let i = 0; i < values.length; i++) {\r\n         a = values[i];\r\n         if (a % 1 !== 0)\r\n            return NaN;\r\n         product *= a;\r\n      }\r\n      return Math.abs(product) / Math.pow(Math.gcd(...values), values.length - 1);\r\n   },\r\n   \r\n   mod: (a, b) =>{\r\n      return a % b;\r\n   }\r\n};\r\n\r\nObject.assign(Math, mathFunc);\r\n\r\nlet vars = {\r\n   pi: Math.PI,\r\n   e: Math.E,\r\n   \r\n};\r\n\r\nObject.assign(Math, vars);\r\n\r\nexport function getJSfunction(input, params, usestrict = true, undefThrowError = true) {\r\n   let result;\r\n   if (input instanceof MagicalParser.Node) {\r\n      result = MathPackage.Parser.parsedTOjsFunction(input, params, 'Math', usestrict);\r\n   } else if ((typeof input).toLowerCase() === 'object') {\r\n      result = MathPackage.Parser.maximaTOjsFunction(MathPackage.Parser.latexTOmaxima(input.value), params, 'Math', usestrict);\r\n   } else {\r\n      result = MathPackage.Parser.maximaTOjsFunction(input, params, 'Math', usestrict);\r\n   }\r\n   if (undefThrowError) {\r\n      if (result.undef.vars.length > 0 || result.undef.funcs.length > 0) throw new UndefError(result.undef);\r\n      return result.func;\r\n   } else {\r\n      return result.func;\r\n   }\r\n}\r\n","import { generateName } from './../global.js';\r\nexport default class GraphChild {\r\n\r\n    /**\r\n     * @param {*} options \r\n     * include these ptoperties: \r\n     * 1. sketch\r\n     * 2. id\r\n     * 3. [pen] ::: for drawable children that will be drawn in the canvas\r\n     * 4. [handlers] ::: { \r\n     *      onchange ::: for the silder,\r\n     *      onupdate :: updating the drawing object that will be useing in the rendering process,\r\n     *      ondrender::: rendering the graphics object coming from the latest finished updating process,\r\n     *      onerror,\r\n     *      onremove\r\n     *  }\r\n     * 5. [renderable] ::: boolean that indecate wheather or not you want to make this graphChild updated and renderd, if it is false so the this is deactivated\r\n     *\r\n     * \r\n     */\r\n    constructor(options, callback) {\r\n\r\n        this.handlers = options.handlers || {};\r\n        this.renderable = options.hasOwnProperty('renderable') ? options.renderable : true;\r\n        if (options.hasOwnProperty('handlers')) delete options.handlers;\r\n        if (options.hasOwnProperty('renderable')) delete options.renderable;\r\n\r\n        if (!options.sketch) {\r\n            throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + 'sketch' + ' property, or it is falsy value');\r\n        } else {\r\n            this.sketch = options.sketch;\r\n            this.gs = this.sketch.gs;\r\n            this.coorManager = this.gs.coorManager;\r\n            delete options.sketch;\r\n        }\r\n\r\n        options.id = options.id || generateName();\r\n        Object.assign(this, options);\r\n\r\n        if(callback) callback(this);\r\n\r\n        this.sketch.children.set(this.id, this); /// this must be at the bottom so that if an error occured, no new graphChild is added\r\n    }\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    set id(value) {\r\n        this._id = this.sketch.gs.checkId(value);\r\n    }\r\n\r\n    /**\r\n     * methods are here\r\n     */\r\n\r\n    update(canvas, handlerArgs = []) {\r\n        if (this.renderable) {\r\n            try {\r\n                this._update(canvas);\r\n            } catch (e) {\r\n                this.error(e);\r\n            }\r\n        }\r\n        if (this.handlers.onupdate) {\r\n            this.handlers.onupdate(...handlerArgs);\r\n        }\r\n    }\r\n\r\n    draw(canvas) {\r\n        if (this.renderable) {\r\n            this._draw(canvas);\r\n        }\r\n    }\r\n\r\n    _update(canvas) {\r\n\r\n    }\r\n\r\n    _draw(canvas) {\r\n\r\n    }\r\n\r\n    remove(handlerArgs = []) {\r\n        this._remove();\r\n        this.sketch.children.delete(this.id);\r\n        if (this.handlers.onremove) this.handlers.onremove(...handlerArgs);\r\n    }\r\n\r\n    _remove() {\r\n\r\n    }\r\n\r\n    error(e) {\r\n        this.handlers.onerror(e);\r\n    }\r\n}\r\n","export default class Canvas{\r\n\r\n   /**\r\n    * to create an instance of Canvas class, this offer some good methods and propeties.\r\n    * @param {Objetc} options \r\n    * you can set parent, canvas, attributes which contains any attribute of html. \r\n    */\r\n   constructor(options = {}) {\r\n      this.elt = options.canvas || document.createElement(\"canvas\");\r\n      if (options.parent) {\r\n         options.parent.appendChild(this.elt);\r\n         this.elt.width = options.parent.clientWidth;\r\n         this.elt.height = options.parent.clientHeight;\r\n      }\r\n      if (options.attributes) {\r\n         for (let name in options.attributes) {\r\n            this.elt.setAttribute(name, options.attributes[name]);\r\n         }\r\n      }\r\n      this.font = { width: 15, family: 'Arial' };\r\n\r\n      this.ctx = this.elt.getContext('2d');\r\n      this.ctx.textBaseline = 'top';\r\n   }\r\n\r\n\r\n   get width() {\r\n      return this.elt.width;\r\n   }\r\n\r\n   get height() {\r\n      return this.elt.height;\r\n   }\r\n\r\n   resize(width, height) {\r\n      let names = ['lineJoin', 'textBaseline', 'miterLimit', 'lineWidth'];\r\n      let props = {};\r\n      for (let p of names) {\r\n         props[p] = this.ctx[p];\r\n      }\r\n      this.elt.width = width;\r\n      this.elt.height = height;\r\n      Object.assign(this.ctx, props);\r\n   }\r\n\r\n   clear(fillStyle, viewport) {\r\n      if (fillStyle) {\r\n         viewport = viewport || [0, 0, this.elt.clientWidth, this.elt.clientHeight];\r\n         this.ctx.fillStyle = fillStyle;\r\n         this.ctx.fillRect(...viewport);\r\n      } else {\r\n         viewport = viewport || [0, 0, this.elt.clientWidth, this.elt.clientHeight];\r\n         this.ctx.clearRect(...viewport);\r\n      }\r\n   }\r\n\r\n   setFont(font) {\r\n      if (font.size) this.font.size = font.size;\r\n      if (font.family) this.font.family = font.family;\r\n      this.ctx.font = `${this.font.size}px ${this.font.family}`;\r\n   }\r\n\r\n   measureString(txt) {\r\n      let size = this.ctx.measureText(txt);\r\n      size.height = this.font.size;\r\n      return size;\r\n   }\r\n\r\n   get transform() {\r\n      return this._trans;\r\n   }\r\n   /**\r\n    * @param {Array} trans : [a, b, c, d, e, f]\r\n    */\r\n   set transform(trans) {\r\n      this._trans = trans;\r\n      let mag2 = ((this._trans[0] + this._trans[2]) ** 2 + (this._trans[1] + this._trans[3]) ** 2) ** 0.5;\r\n   }\r\n\r\n   setTransform(...params) {\r\n      this.transform = params;\r\n      this.ctx.setTransform(...params);\r\n   }\r\n\r\n   getTransform() {\r\n      return this.transform;\r\n   }\r\n\r\n   get lineWidth() {\r\n      return this.lw;\r\n   }\r\n\r\n   set lineWidth(lw) {\r\n      let mag = ((this._trans[0] + this._trans[2]) ** 2 + (this._trans[1] + this._trans[3]) ** 2) ** 0.5;\r\n      this.ctx.lineWidth = lw / mag;\r\n      this.lw = lw;\r\n   }\r\n\r\n   //#region shapes\r\n\r\n   line(x1, y1, x2, y2) {\r\n      this.ctx.moveTo(x1, y1);\r\n      this.ctx.lineTo(x2, y2);\r\n   }\r\n\r\n   ellipse(x, y, radius1, radius2, rotation = 0, startAngle = 0, endAngle = Math.PI*2, counterClockWise = false) {\r\n      radius2 = radius2 || radius1;\r\n      this.ctx.beginPath();\r\n      this.ctx.ellipse(x, y, radius1, radius2 || radius1, rotation, startAngle, endAngle, counterClockWise);\r\n      this.ctx.fill();\r\n      this.ctx.stroke();\r\n   }\r\n\r\n   //#endregion\r\n\r\n}","import Canvas from './../Canvas.js';\r\nexport class pen{\r\n    constructor(color, weight = 1, style = 'solid'){\r\n        this.color = color;\r\n        this.weight = weight;\r\n        this.style = style;\r\n    }\r\n    setup(canvasORctx) {\r\n        canvasORctx = canvasORctx instanceof Canvas ? canvasORctx.ctx : canvasORctx;\r\n        canvasORctx.strokeStyle = this.color.toString();\r\n        canvasORctx.lineWidth = this.weight;\r\n    }\r\n}\r\n\r\nexport class color{\r\n    constructor(r, g, b, a) {\r\n        this.r = r;\r\n        this.g = g;\r\n        this.b = b;\r\n        this.a = a;\r\n    }\r\n\r\n    get brightness() {\r\n        let num = this.r / 255;\r\n        let num2 = this.g / 255;\r\n        let num3 = this.b / 255;\r\n        let num4 = num;\r\n        let num5 = num;\r\n        if (num2 > num4)\r\n            num4 = num2;\r\n        if (num3 > num4)\r\n            num4 = num3;\r\n        if (num2 < num5)\r\n            num5 = num2;\r\n        if (num3 < num5)\r\n            num5 = num3;\r\n        return ((num4 + num5) / 2);\r\n    }\r\n\r\n    get hue() {\r\n        if ((this.r == this.g) && (this.g == this.b))\r\n            return 0;\r\n        let num = this.r / 255;\r\n        let num2 = this.g / 255;\r\n        let num3 = this.b / 255;\r\n        let num7 = 0;\r\n        let num4 = num;\r\n        let num5 = num;\r\n        if (num2 > num4)\r\n            num4 = num2;\r\n        if (num3 > num4)\r\n            num4 = num3;\r\n        if (num2 < num5)\r\n            num5 = num2;\r\n        if (num3 < num5)\r\n            num5 = num3;\r\n        let num6 = num4 - num5;\r\n        if (num == num4)\r\n            num7 = (num2 - num3) / num6;\r\n        else if (num2 == num4)\r\n            num7 = 2 + ((num3 - num) / num6);\r\n        else if (num3 == num4)\r\n            num7 = 4 + ((num - num2) / num6);\r\n        num7 *= 60;\r\n        if (num7 < 0)\r\n            num7 += 360;\r\n        return num7;\r\n    }\r\n\r\n    get saturation() {\r\n        let num = this.r / 255;\r\n        let num2 = this.g / 255;\r\n        let num3 = this.b / 255;\r\n        let num7 = 0;\r\n        let num4 = num;\r\n        let num5 = num;\r\n        if (num2 > num4)\r\n            num4 = num2;\r\n        if (num3 > num4)\r\n            num4 = num3;\r\n        if (num2 < num5)\r\n            num5 = num2;\r\n        if (num3 < num5)\r\n            num5 = num3;\r\n        if (num4 == num5)\r\n            return num7;\r\n        let num6 = (num4 + num5) / 2;\r\n        if (num6 <= 0.5)\r\n            return ((num4 - num5) / (num4 + num5));\r\n        return ((num4 - num5) / ((2 - num4) - num5));\r\n    }\r\n\r\n    isDark() {\r\n        if (this.brightness > 0.40) {\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    toArray(override = {}) {\r\n        return [\r\n            override.r || override.r === 0 ? override.r : this.r,\r\n            override.g || override.g === 0 ? override.g : this.g,\r\n            override.b || override.b === 0 ? override.b : this.b,\r\n            override.a || override.a === 0 ? override.a : this.a\r\n        ];\r\n    }\r\n\r\n    toString(override = {}) { \r\n        return `rgba(${this.toArray(override).join(', ')})`;\r\n    }\r\n}\r\n\r\n/**\r\n * our color is an object has r g b as properties. {r: num, g: num, b: num}\r\n */\r\nexport class colorPackage{\r\n    static brightness(color) {\r\n        let num = color.r / 255;\r\n        let num2 = color.g / 255;\r\n        let num3 = color.b / 255;\r\n        let num4 = num;\r\n        let num5 = num;\r\n        if (num2 > num4)\r\n            num4 = num2;\r\n        if (num3 > num4)\r\n            num4 = num3;\r\n        if (num2 < num5)\r\n            num5 = num2;\r\n        if (num3 < num5)\r\n            num5 = num3;\r\n        return ((num4 + num5) / 2);\r\n    }\r\n\r\n    static hue(color) {\r\n        if ((color.r == color.g) && (color.g == color.b))\r\n            return 0;\r\n        let num = color.r / 255;\r\n        let num2 = color.g / 255;\r\n        let num3 = color.b / 255;\r\n        let num7 = 0;\r\n        let num4 = num;\r\n        let num5 = num;\r\n        if (num2 > num4)\r\n            num4 = num2;\r\n        if (num3 > num4)\r\n            num4 = num3;\r\n        if (num2 < num5)\r\n            num5 = num2;\r\n        if (num3 < num5)\r\n            num5 = num3;\r\n        let num6 = num4 - num5;\r\n        if (num == num4)\r\n            num7 = (num2 - num3) / num6;\r\n        else if (num2 == num4)\r\n            num7 = 2 + ((num3 - num) / num6);\r\n        else if (num3 == num4)\r\n            num7 = 4 + ((num - num2) / num6);\r\n        num7 *= 60;\r\n        if (num7 < 0)\r\n        num7 += 360;\r\n        return num7;\r\n    }\r\n\r\n    static saturation(color) {\r\n        let num = color.r / 255;\r\n        let num2 = color.g / 255;\r\n        let num3 = color.b / 255;\r\n        let num7 = 0;\r\n        let num4 = num;\r\n        let num5 = num;\r\n        if (num2 > num4)\r\n            num4 = num2;\r\n        if (num3 > num4)\r\n            num4 = num3;\r\n        if (num2 < num5)\r\n            num5 = num2;\r\n        if (num3 < num5)\r\n            num5 = num3;\r\n        if (num4 == num5)\r\n            return num7;\r\n        let num6 = (num4 + num5) / 2;\r\n        if (num6 <= 0.5)\r\n            return ((num4 - num5) / (num4 + num5));\r\n        return ((num4 - num5) / ((2 - num4) - num5));\r\n    }\r\n    static isDark(color) {\r\n        if (colorPackage.brightness(color) > 0.35) {\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    static randomColor() {\r\n        return new color(MathPackage.Core.random(255), MathPackage.Core.random(255),  MathPackage.Core.random(255));\r\n    }\r\n\r\n    static randomDarkColor() {\r\n        let c = colorPackage.randomColor();\r\n        do { c = colorPackage.randomColor(); } while (!c.isDark());\r\n        return c;\r\n    }\r\n\r\n    static randomLightColor() {\r\n        let c = colorPackage.randomColor();\r\n        do { c = colorPackage.randomColor(); } while (c.isDark());\r\n        return c;\r\n    }\r\n}\r\n\r\nexport function measureString(txt) {\r\n    return canvas.elt.getContext(\"2d\").measureText(txt);\r\n}","/****************************************************************/\r\n/****************************************************************/\r\n/****************************************************************/\r\nimport GraphChild from '../GraphChild.js';\r\nimport drawing from '../../drawing/index.js';\r\nimport { getJSfunction } from '../../global.js';\r\n\r\nexport default class Xfunction extends GraphChild {\r\n   /** \r\n    * gs stands for graphSetting.\r\n   */\r\n   constructor(options) {\r\n      //#region \r\n      let idExists = options.id;\r\n      if (!options.expr) {\r\n         throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + propName + ' property, or it is falsy value');\r\n      }\r\n      if (!options.pen) {\r\n         let c = options.sketch.coor.coorSettings.background.isDark() ? drawing.colorPackage.randomLightColor() : drawing.colorPackage.randomDarkColor();\r\n         c.a = 155;\r\n         options.pen = new drawing.pen(c, 2);\r\n      }\r\n      //#endregion\r\n      \r\n      super(options, (me) => {\r\n         me.expression = getJSfunction(me.expr, ['x'], true);\r\n         me.path = new Path2D();\r\n\r\n         if (idExists) {\r\n            Math[me.id] = me.expression;\r\n         }\r\n      });\r\n      \r\n   }\r\n\r\n   static fromString(expr, sketch) {\r\n      if (str.replace(/==+/, '').indexOf('=') > -1) throw new Error('there is \"=\" opertor!');\r\n      return new Xfunction({ expr, sketch });\r\n   }\r\n\r\n   async _update(canvas) {\r\n\r\n      let p, previousP, midP, continous;\r\n      let path = new Path2D();\r\n      for (let x = this.gs.viewport.xmin; x <= this.gs.viewport.xmax; x += this.gs.drawingStep) {\r\n         p = this.coorManager.coorTOpx(x, this.expression(x));\r\n         midP = this.coorManager.coorTOpx(x - this.gs.drawingStep / 2, this.expression(x - this.gs.drawingStep / 2));\r\n         // if valid add new point, unless add the array of point if has more than point\r\n         let valid = !isNaN(p.x) && !isNaN(p.y) &&\r\n            Math.abs(p.x) < 100000 && Math.abs(p.y) < 100000 &&\r\n            ((continous && (Math.sign(p.y - midP.y) === Math.sign(midP.y - previousP.y) || Math.abs(p.y - previousP.y) / this.gs.drawingStep < 20)) || !continous);\r\n         if (!valid) {\r\n            if (continous) {\r\n               continous = false;\r\n            }\r\n         }\r\n         else {\r\n            if (continous)\r\n               path.lineTo(p.x, p.y);\r\n            else\r\n               path.moveTo(p.x, p.y);\r\n\r\n            previousP = { x: p.x, y: p.y };\r\n            continous = true;\r\n         }\r\n      }\r\n\r\n      this.path = path;\r\n   }\r\n\r\n   _draw(canvas) {\r\n      let ctx = canvas.ctx;\r\n      ctx.strokeStyle = this.pen.color.toString();\r\n      ctx.lineWidth = this.pen.weight;\r\n      ctx.stroke(this.path);\r\n   }\r\n\r\n   _remove() {\r\n      delete Math[this.id];\r\n   }\r\n\r\n   toString() {\r\n      return this.expression;\r\n   }\r\n\r\n}\r\n","\r\nimport GraphChild from './GraphChild.js';\r\nimport { getJSfunction } from '../global.js';\r\nexport default class Point extends GraphChild {\r\n\r\n    constructor(options) {\r\n        \r\n        //#region \r\n        options.pen = options.pen || new drawing.pen(new drawing.color(0, 0, 255), 10);\r\n        let propName;\r\n\r\n        propName = 'x';\r\n        if (!options[propName]) {\r\n            throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + propName + ' property, or it is falsy value');\r\n        }\r\n\r\n        propName = 'y';\r\n        if (!options[propName]) {\r\n            throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + propName + ' property, or it is falsy value');\r\n        }\r\n        //#endregion\r\n\r\n        super(options, (me) => {\r\n            me.x = getJSfunction(me.x);\r\n            me.y = getJSfunction(me.y);\r\n        });\r\n\r\n    }\r\n\r\n    static fromString(str, sketch) {\r\n        if (str) {\r\n            let p;\r\n            let regex = /^\\s*\\(\\s*(.+?)\\s*,\\s*(.+?)\\s*\\)\\s*$/;\r\n            str.replace(regex, (match, x, y) => {\r\n                p = new Point({ sketch, x, y });\r\n            });\r\n            if (!p)\r\n                throw new Error('error while trying to add a point: ' + str);\r\n            else\r\n                return p;\r\n        }\r\n        else\r\n            throw new Error('your str is empty :\\'(');\r\n    }\r\n\r\n    draw(canvas, handlerArgs = []) {\r\n\r\n        if (this.renderable) {\r\n            switch (this.pen.style) {\r\n                case 'solid':\r\n                    canvas.strokeWeight(2);\r\n                    canvas.stroke(200);\r\n                    canvas.fill(...(this.pen.color.toArray().splice(0, 3)), 150);\r\n                    break;\r\n                case 'shallow':\r\n                    canvas.ctx.lineWidth = 3;\r\n                    canvas.ctx.strokeStyle(this.pen.color.toString());\r\n                    canvas.ctx.fillStyle(this.sketch.coor.coorSettings.background.toString());\r\n                    break;\r\n            }\r\n            let p = this.coorManager.coorTOpx(this.x.eval(), this.y.eval());\r\n            canvas.ellipse(p.x, p.y, this.pen.weight, this.pen.weight);\r\n        }\r\n\r\n        if (this.handlers.onupdate) {\r\n            this.handlers.onupdate(...handlerArgs);\r\n        }\r\n\r\n    }\r\n\r\n    toString() {\r\n        return `(${this.x}, ${this.y})`;\r\n    }\r\n\r\n}\r\n","import GraphChild from \"./GraphChild.js\";\r\nimport { getJSfunction } from '../global.js';\r\n\r\nexport default class EvalExpr extends GraphChild {\r\n   constructor(options) {\r\n      //#region \r\n      let propName;\r\n      propName = 'expr';\r\n      if (!options[propName]) {\r\n         throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + propName + ' property, or it is falsy value');\r\n      }\r\n      //#endregion\r\n\r\n      super(options, (me) => {\r\n         me.evalFunc = getJSfunction(me.expr);\r\n      });\r\n\r\n   }\r\n\r\n   static fromString(str, sketch) {\r\n      if (str) {\r\n         // TODO: getting it from \"a = 1+2/4\"\r\n         return new EvalExpr({ expr: expr });\r\n      }\r\n      else\r\n         throw new Error('your expression is empty :\\'(');\r\n   }\r\n\r\n   eval() {\r\n      try {\r\n         return this.evalFunc();\r\n      } catch (e) {\r\n         this.error(e);\r\n      }\r\n   }\r\n\r\n}","import GraphChild from \"./GraphChild.js\";\r\nimport { getJSfunction } from '../global.js';\r\n\r\nexport default class Constant /** or slider */ extends GraphChild {\r\n\r\n   constructor(options) {\r\n      //#region\r\n      let propName;\r\n      propName = 'id';\r\n      if (!options[propName]) {\r\n         throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + 'name' + ' property, or it is falsy value');\r\n      }\r\n      propName = 'value';\r\n      if (!options[propName]) {\r\n         throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + 'name' + ' property, or it is falsy value');\r\n      }\r\n      //#endregion\r\n      super(options, (me) => {\r\n         if (!me.id.match(/[a-zA-Z_]+\\d*/)) throw new Error(`${me.id} is invalid.`);\r\n         me.value = { valueOf: getJSfunction(me.value) };\r\n         Math[me.id] = me.value;\r\n      });\r\n   }\r\n\r\n   setValue(value, handlerOptions = []) {\r\n      Math[this.id] = value;\r\n      if (this.handlers.onchange) this.handlers.onchange(...handlerOptions);\r\n   }\r\n\r\n   getValue() {\r\n      return Math[this.id];\r\n   }\r\n\r\n   _remove() {\r\n      delete Math[this.id];\r\n   }\r\n\r\n}","import GraphChild from \"./GraphChild.js\";\r\nimport { getJSfunction } from '../global.js';\r\n\r\nexport default class Func /** or slider */ extends GraphChild {\r\n\r\n   constructor(options) {\r\n      //#region \r\n      let propName;\r\n      propName = 'id';\r\n      if (!options[propName]) {\r\n         throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + 'name' + ' property, or it is falsy value');\r\n      }\r\n      propName = 'expr';\r\n      if (!options[propName]) {\r\n         throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + 'name' + ' property, or it is falsy value');\r\n      }\r\n      propName = 'params';\r\n      if (!options[propName]) {\r\n         throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + 'name' + ' property, or it is falsy value');\r\n      }\r\n      //#endregion\r\n\r\n      super(options, () => {\r\n         if (!this.id.match(/[a-zA-Z_]+\\d*/)) throw new Error(`${this.id} is invalid.`);\r\n         this.func = getJSfunction(options.expr, options.params);\r\n         Math[this.id] = this.func;\r\n\r\n      });\r\n\r\n   }\r\n\r\n   _remove() {\r\n      delete Math[this.id];\r\n   }\r\n\r\n}","import GraphChild from \"./GraphChild.js\";\r\n\r\nexport default class Empty extends GraphChild {\r\n   constructor(options) {\r\n      super(options);\r\n   }\r\n}","import GraphChild from \"./GraphChild.js\";\r\nimport { getJSfunction } from '../global.js';\r\n\r\nexport default class Slider /** or slider */ extends GraphChild {\r\n   \r\n   constructor(options) {\r\n      //#region \r\n      let propName;\r\n      propName = 'id';\r\n      if (!options[propName]) {\r\n         throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + propName + ' property, or it is falsy value');\r\n      }\r\n      propName = 'value';\r\n      if (!options[propName]) {\r\n         throw new Error('Your options passed to the shetchChild is not valid, it doesn\\'t has ' + propName + ' property, or it is falsy value');\r\n      }\r\n      //#endregion\r\n      super(options, (me) => {\r\n         if (!me.id.match(/[a-zA-Z_]+\\d*/)) throw new Error(`${me.id} is invalid.`);\r\n         Math[me.id] = me.value;\r\n      });\r\n\r\n   }\r\n\r\n   setValue(value, handlerOptions = []) {\r\n      Math[this.id] = value;\r\n      if (this.handlers.onchange) this.handlers.onchange(...handlerOptions);\r\n   }\r\n\r\n   getValue() {\r\n      return Math[this.id];\r\n   }\r\n\r\n   _remove() {\r\n      delete Math[this.id];\r\n   }\r\n\r\n}","\r\nimport { addControl, removeControl, genRandomName, keypadSettings } from './global.js';\r\nimport { Xfunction, XYfunction, Point, EvalExpr, Constant, Empty, Slider, Func } from '../PLOTTO/GraphChildren/index.js';\r\nimport { UndefError, ExistBefore } from '../PLOTTO/Errors/index.js';\r\nexport default class ChildControl {\r\n   constructor(graphChild) {\r\n      this.elt = document.createElement('div');\r\n      this.elt.innerHTML = `\r\n      <li class=\"control\" id=\"${this.id}\">\r\n        <div class=\"side-status\" cancel-move>\r\n          <div class=\"order-container\">\r\n            <span class='order'>12</span>\r\n          </div>\r\n        </div>\r\n        <div class=\"main\" cancel-move cancel-hiding-keypad>\r\n         <div class=script-container><span type=\"text\" class=\"script\"></span></div>\r\n        </div>\r\n        <div class=\"side-ctrl\">\r\n          <button class=\"closebtn-2 remove\" cancel-move><div class=\"inner\"></div></button>\r\n          <span class=\"move\">\r\n            <div>\r\n              <span>..</span>\r\n              <span>..</span>\r\n              <span>..</span>\r\n            </div>\r\n          </span>\r\n        </div>\r\n      </li>\r\n      `;\r\n      this.elt = (this.elt.childNodes[1]);\r\n\r\n      this.status = 'ready';\r\n      this.graphChild = graphChild || new Empty({ sketch: mySketch, control: this });\r\n      this.__updateElts(null, this.graphChild);\r\n\r\n      this.setEvents();\r\n   }\r\n\r\n   get id() {\r\n      return this._id;\r\n   }\r\n\r\n   set id(newid) {\r\n      this._id = newid;\r\n      this.elt.id = newid;\r\n   }\r\n\r\n   get graphChild() {\r\n      return this._graphChild;\r\n   }\r\n\r\n   set graphChild(value) {\r\n      this._graphChild = value;\r\n      this.id = value.id;\r\n   }\r\n\r\n   setEvents() {\r\n      let scriptELT = this.elt.querySelector('.script');\r\n      this.removeELT = this.elt.querySelector('.remove');\r\n      this.orderELT = this.elt.querySelector('.order');\r\n\r\n      //#region math, script field\r\n      let mathField = MQ.MathField(scriptELT, {\r\n         handlers: {\r\n            edit: () => {\r\n               if (this.status === 'ready') this.update(mathField.latex());\r\n               else this.status = 're-update';\r\n            },\r\n\r\n            enter: () => {\r\n               this.enter();\r\n            },\r\n         }\r\n      });\r\n      this.mathField = mathField;\r\n      //#endregion \r\n\r\n      this.elt.querySelector('.main').addEventListener('focusin', (e) => {\r\n         this.focus(false);\r\n      });\r\n\r\n      this.elt.querySelector('.main').addEventListener('focusout', (e) => {\r\n         this.blur(false);\r\n      });\r\n\r\n      this.removeELT.addEventListener('click', (e) => {\r\n         this.remove();\r\n      });\r\n\r\n   }\r\n\r\n   async update(latex) {\r\n      if (!this.disableHandling) {\r\n         this.status = 'updating';\r\n         this._graphChild.remove();\r\n         this.id = undefined;\r\n         try {\r\n            let prev = this._graphChild;\r\n            if (latex === '') {\r\n               this.parsedScript = new MagicalParser.Node('');\r\n               this.graphChild = new Empty({ sketch: mySketch });\r\n            } else {\r\n               if (latex) {\r\n                  this.parsedScript = null; /// so when an error occur in the next code, in the necxt time the parsed script will be null.\r\n                  this.parsedScript = mySketch.scriptParser.parse(MathPackage.Parser.latexTOmaxima(latex));\r\n                  this.vars = this.__getAll(this.parsedScript, { type: 'variable' }).map(a => a.name);\r\n                  this.funcs = this.__getAll(this.parsedScript, { type: 'functionCalling' }).map(a => a.name);\r\n               }\r\n              \r\n               if (!this.parsedScript) return; /// syntax error ocurred, no possible update exist, this error happen before and now the parsedString is null, the error elt exists and stop updating all is done\r\n              \r\n               let props = {\r\n                  handlers: {\r\n                     onremove: (removeElt) => {\r\n                        if (removeElt) this.remove(false);\r\n                     },\r\n                     onerror: (e) => {\r\n                        this.error(e);\r\n                     }\r\n                  },\r\n                  control: this,\r\n               };\r\n\r\n               if (this.graphChild && this.graphChild.pen) props.pen = this.graphChild.pen;\r\n               this.graphChild = mySketch.childFromParsed(this.parsedScript, props); /// the parsed string is valid, no error are predicted on fetching the gc\r\n            }\r\n            this.__updateElts(\r\n               prev,\r\n               this.graphChild\r\n            );\r\n         } catch (e) {\r\n            this.error(e);\r\n         }\r\n         if (!this.id) {\r\n            /// consequently, am error occured, before assigning the new gc, after deleting the preious one.\r\n            /// reverse the effect\r\n            if (this._graphChild) {\r\n               this.id = this._graphChild.id;\r\n               mySketch.children.set(this.id, this.graphChild);\r\n            }\r\n         }\r\n         this.__updateDependants();\r\n         mySketch.update();\r\n         if (this.status === 're-update') {\r\n            this.update();\r\n         } else if(this.status === 'updating'){\r\n            this.status = 'ready';\r\n         }\r\n      }\r\n   }\r\n\r\n   __getAll(parsed, check = {}) {\r\n      let vars = [];\r\n      if (parsed.check(check)) {\r\n         return [parsed];\r\n      } else {\r\n         for (let i = 0; i < parsed.args.length; i++) {\r\n            vars = vars.concat(this.__getAll(parsed.args[i], check));\r\n         }\r\n      }\r\n      return vars;\r\n   }\r\n\r\n   __updateDependants(prev) {\r\n      if (this._graphChild instanceof Constant || this._graphChild instanceof Slider) {\r\n         let size = mySketch.children.size;\r\n         mySketch.children.forEach(gc => {\r\n            size--;\r\n            if (size < 0) return;\r\n            if (gc && gc !== this._graphChild && gc.control.vars) {\r\n               if (gc.control.vars.find(a => this._graphChild.id === a || (prev && a === prev.id)))\r\n                  gc.control.update();\r\n            }\r\n         });\r\n      }\r\n      if (this._graphChild instanceof Func) {\r\n         let size = mySketch.children.size;\r\n         mySketch.children.forEach(gc => {\r\n            size--;\r\n            if (size < 0) return;\r\n            if (gc && gc.control !== this && gc.control.vars) {\r\n               if (gc.control.funcs.find(a => this._graphChild.id === a || (prev && a === prev.id)))\r\n                  gc.control.update();\r\n            }\r\n         });\r\n      }\r\n   }\r\n\r\n   setScript(script, handle = true) {\r\n      if (!handle) {\r\n         this.disableHandling = true;\r\n      }\r\n      this.mathField.latex(script);\r\n      if (!handle) {\r\n         this.disableHandling = false;\r\n      }\r\n   }\r\n\r\n   focus(focusTheField = true) {\r\n      if (keypadSettings.focusedControl && keypadSettings.focusedControl !== this) keypadSettings.focusedControl.blur();\r\n      // setting this to be focuses\r\n      keypadSettings.focusedControl = this;\r\n      keypadSettings.mathField = this.mathField;\r\n      if (focusTheField) this.mathField.focus();\r\n      this.elt.classList.add('focus');\r\n   }\r\n\r\n   blur(blurTheField = true) {\r\n      // keypadSettings.focusedControl = undefined;\r\n      if (blurTheField) this.mathField.blur();\r\n      this.elt.classList.remove('focus');\r\n   }\r\n\r\n   enter() {\r\n      let index = parseInt(this.orderELT.textContent);\r\n      if (this.isError === 1) {\r\n         this.blur();\r\n         /// adding undefined\r\n         let vars = this.elt.querySelectorAll('.not-exist .var');\r\n         for (let v of vars) {\r\n            v.click();\r\n            index++;\r\n         }\r\n\r\n         let funcs = this.elt.querySelectorAll('.not-exist .func');\r\n         for (let f of funcs) {\r\n            f.click();\r\n            index++;\r\n         }\r\n      }\r\n      let newChild = new ChildControl();\r\n      addControl(newChild, index);\r\n   }\r\n\r\n   error(e) {\r\n      if (e instanceof UndefError) {\r\n         let undef = e.undef;\r\n         let undefVars = undef.vars.reduce((b, a) => b + a + ', ', '').slice(0, -2);\r\n         let undefFuncs = undef.funcs.reduce((b, a) => b + a + ', ', '').slice(0, -2);\r\n         let errorText = (undefVars ? `undefined vars [${undefVars}]` : '') + (undefFuncs ? `, undefined funcs [${undefFuncs}]` : '');\r\n         this.error(new Error(errorText + ', click the button to add.'));\r\n\r\n         if (this.isError === 1) { // this.isError is 1 when vars or funcs are not exists\r\n            /// remove the previous elts\r\n            this.elt.querySelector('.main .not-exist').remove();\r\n         }\r\n\r\n         let buttonsVars = '', buttonsFuncs = '';\r\n\r\n         if (undef.vars.length > 0) {\r\n            buttonsVars = '<div><span>vars: </span>';\r\n            buttonsVars += undef.vars.reduce((b, a) => { return b + `<button class=\"var\">${a}</button>`; }, '') || '';\r\n            buttonsVars += undef.vars.length > 1 ? '<button class=\"all-vars\">all</button>' : '';\r\n            buttonsVars += '</div>';\r\n         }\r\n\r\n         if (undef.funcs.length > 0) {\r\n            buttonsFuncs = '<div><span>funcs: </span>';\r\n            buttonsFuncs += undef.funcs.reduce((b, a) => { return b + `<button class=\"func\">${a}</button>`; }, '') || '';\r\n            buttonsFuncs += undef.funcs.length > 1 ? '<button class=\"all-funcs\">all</button>' : '';\r\n            buttonsFuncs += '</div>';\r\n         }\r\n\r\n         let addVarsElt = $(`<div class='not-exist'>${buttonsVars + buttonsFuncs}</div>`);\r\n\r\n         let me = this;\r\n         $('.var', addVarsElt).bind('click', function () {\r\n            let id = this.innerText;\r\n            // let gc = new ChildControl(new Slider({ id, value: 1, sketch: mySketch }));\r\n            addControl(`${id} = 1`, parseInt(me.orderELT.textContent));\r\n         });\r\n\r\n         $('.func', addVarsElt).bind('click', function () {\r\n            /// choosing a param\r\n            let param = 'a';\r\n            let counter = 0;\r\n            let end;\r\n            while (Math.hasOwnProperty(param) && !end) {\r\n               if (counter > 300) {\r\n                  param = 'a';\r\n                  end = 1;\r\n               } else if (counter > 100) {\r\n                  param = String.fromCharCode(math.random(65, 90));\r\n               } else {\r\n                  param = String.fromCharCode(math.random(97, 122));\r\n               }\r\n               counter++;\r\n            }\r\n            let id = this.textContent;\r\n            // let newChild = new ChildControl(new Func({ id, expr: new MagicalParser.Node('variable', [], { name: param }), params: [param], sketch: mySketch }));\r\n            addControl(`${id}\\\\left(${param}\\\\right) = ${param}`, parseInt(me.orderELT.textContent));\r\n         });\r\n\r\n         $('.all-vars', addVarsElt).bind('click', function () {\r\n            let vars = this.elt.querySelectorAll('.not-exist .var');\r\n            for (let v of vars) {\r\n               v.click();\r\n            }\r\n         });\r\n\r\n         $('.all-funcs', addVarsElt).bind('click', () => {\r\n            let funcs = this.elt.querySelectorAll('.not-exist .func');\r\n            for (let f of funcs) {\r\n               f.click();\r\n            }\r\n         });\r\n\r\n         this.elt.querySelector('.main').append(addVarsElt[0]);\r\n         this.isError = 1;\r\n\r\n      } else {\r\n         if (this.isError) {\r\n            let errorELT = this.elt.querySelector('.error-elt');\r\n            errorELT.setAttribute('aria-label', e.message);\r\n         } else {\r\n            this.elt.classList.add('error');\r\n            this.isError = true;\r\n            this.graphChild.renderable = false;\r\n            let errorELT = $(`\r\n            <div class=\"error-elt\">\r\n               <i class=\"fas fa-bug\"></i>\r\n            </div>\r\n            `);\r\n            errorELT[0].setAttribute('data-balloon-pos', 'right');\r\n            errorELT[0].setAttribute('aria-label', e.message);\r\n            errorELT.hide();\r\n            this.elt.querySelector('.side-status').append(errorELT[0]);\r\n            errorELT.fadeOut(0).delay(200).fadeIn(500);\r\n         }\r\n         console.log(e);\r\n      }\r\n   }\r\n\r\n   remove(removeGraphChild = true) {\r\n      removeControl(this);\r\n      if (removeGraphChild) {\r\n         if (this.graphChild) this.graphChild.remove();\r\n         this.__updateDependants();\r\n      }\r\n      mySketch.update();\r\n   }\r\n\r\n   //#region updatingElt\r\n\r\n   __updateElts(from, to) {\r\n      if (this.isError === 1) {\r\n         this.elt.querySelector('.not-exist').remove();\r\n      }\r\n\r\n      if (this.isError) {\r\n         this.elt.classList.remove('error');\r\n         this.elt.querySelector('.error-elt').remove();\r\n         this.isError = false;\r\n      }\r\n\r\n      if (to) {\r\n         if (to instanceof Empty) {\r\n            this.__toEmpty();\r\n         } else if (to instanceof Xfunction) {\r\n            if (from instanceof Xfunction) {\r\n               this.__updateXfunction();\r\n            } else {\r\n               this.__toXfunction();\r\n            }\r\n         } else if (to instanceof EvalExpr) {\r\n            if (from instanceof EvalExpr) {\r\n               this.__updateEvalExpr();\r\n            } else {\r\n               this.__toEvalExpr();\r\n            }\r\n         } else if (to instanceof Constant) {\r\n            if (from instanceof Constant) {\r\n               this.__updateConstant();\r\n            } else {\r\n               this.__toConstant();\r\n            }\r\n         } else if (to instanceof Slider) {\r\n            if (from instanceof Slider) {\r\n               this.__updateSlider();\r\n            } else {\r\n               this.__toSlider();\r\n            }\r\n         }\r\n      }\r\n   }\r\n\r\n   __toEmpty() {\r\n      let sideStatus = this.elt.querySelector('.side-status');\r\n      let eltsTOremove = this.elt.querySelectorAll('.special-elt');\r\n      eltsTOremove.forEach(elt => { elt.remove(); });\r\n   }\r\n\r\n   __toXfunction() {\r\n      let sideStatus = this.elt.querySelector('.side-status');\r\n      let eltsTOremove = this.elt.querySelectorAll('.special-elt');\r\n      eltsTOremove.forEach(elt => { elt.remove(); });\r\n      sideStatus.append($(`<div class=\"visible special-elt\"><div class=\"inner\"></div></div>`)[0]);\r\n      this.__updateXfunction();\r\n   }\r\n\r\n   __updateXfunction() {\r\n      let visibleELt = this.elt.querySelector('.side-status').querySelector('.visible');\r\n      visibleELt.setAttribute('style', `--color: ${this.graphChild.pen.color.toString()}`);\r\n   }\r\n\r\n   __toEvalExpr() {\r\n      let eltsTOremove = this.elt.querySelectorAll('.special-elt');\r\n      eltsTOremove.forEach(elt => { elt.remove(); });\r\n\r\n      let value = $(`<div class=\"value special-elt\"><span></span></div>`);\r\n      value.hide();\r\n      this.elt.querySelector('.main').append(value[0]);\r\n      value.fadeIn();\r\n      let valueType = $(\r\n         `<div class=\"value-type special-elt\" type=decimal>\r\n            <span><i class=\"fas fa-divide\"></i></span>\r\n         </div>`\r\n      );\r\n      this.elt.querySelector('.side-status').append(valueType[0]);\r\n      valueType.click(() => {\r\n         switch (valueType.attr('type')) {\r\n            case 'decimal':\r\n               valueType.attr('type', 'fract');\r\n               value.height(56);\r\n               break;\r\n            case 'fract':\r\n               valueType.attr('type', 'quotient');\r\n               value.height(56);\r\n               break;\r\n            case 'quotient':\r\n               valueType.attr('type', 'decimal');\r\n               value.height(33);\r\n               break;\r\n         }\r\n         this.__updateEvalExpr();\r\n      });\r\n\r\n      this.specialProps = {\r\n         valueType: valueType[0],\r\n         valueElt: value[0]\r\n      };\r\n      this.graphChild.handlers.onupdate = () => {\r\n         this.__updateEvalExpr();\r\n      };\r\n      // this.__updateEvalExpr(); /// will be done on updating the sktech\r\n   }\r\n\r\n   __updateEvalExpr() {\r\n      this.graphChild.handlers.onupdate = () => {\r\n         this.__updateEvalExpr();\r\n      };\r\n\r\n      try {\r\n         let value = this.graphChild.eval();\r\n         if (isNaN(value)) throw new Error('error on evaluating, it seems to be cause by undefined variable.');\r\n         value += 0; /// +0 is here to convert the object (representing the valueOf a variable) into a number \r\n         switch (this.specialProps.valueType.getAttribute('type')) {\r\n            case 'decimal':\r\n               {\r\n                  this.specialProps.valueElt.innerHTML = `<span>${value}</span>`;\r\n               }\r\n               break;\r\n            case 'fract':\r\n               {\r\n                  let fraction = MathPackage.Core.fraction(value);\r\n                  if (fraction.denominator === 1) {\r\n                     this.specialProps.valueElt.innerHTML = `<span>${fraction.numerator}</span>`;\r\n                  } else {\r\n                     this.specialProps.valueElt.innerHTML = `<span>\\\\frac{${fraction.numerator}}{${fraction.denominator}}</span>`;\r\n                     MQ.StaticMath(this.specialProps.valueElt.children[0]);\r\n                  }\r\n               }\r\n               break;\r\n            case 'quotient':\r\n               {\r\n                  let fraction = MathPackage.Core.quotientRemainder(value);\r\n                  if (fraction.numerator === 0) {\r\n                     this.specialProps.valueElt.innerHTML = `<span>${fraction.quotient}</span>`;\r\n                  } else {\r\n                     if (fraction.quotient == 0) {\r\n                        this.specialProps.valueElt.innerHTML = `<span>\\\\frac{${fraction.numerator}}{${fraction.denominator}}</span>`;\r\n                     } else {\r\n                        this.specialProps.valueElt.innerHTML = `<span>${fraction.quotient}\\\\frac{${fraction.numerator}}{${fraction.denominator}}</span>`;\r\n                     }\r\n                     MQ.StaticMath(this.specialProps.valueElt.children[0]);\r\n                  }\r\n               }\r\n               break;\r\n         }\r\n      } catch (e) {\r\n         this.specialProps.valueElt.innerHTML = '<span>NaN</span>';\r\n         this.error(e);\r\n      }\r\n   }\r\n\r\n   __toSlider() {\r\n      let eltsTOremove = this.elt.querySelectorAll('.special-elt');\r\n      eltsTOremove.forEach(elt => { elt.remove(); });\r\n\r\n      // for (let [id, gc] of mySketch.children) {\r\n      //    gc.control.update();\r\n      // }\r\n\r\n      /// adding slider\r\n      let sliderOuter = $(`\r\n      <div class=\"slider-outer special-elt\">\r\n         <div class='range-container'>\r\n            <span class='slider-controller-toggle'><i class=\"fas fa-sort-down\"></i></span>\r\n            <input type=range class=slider min=-5 max=5 step=0.1 />\r\n            <span class='play-pause'><i class=\"fas fa-play\"></i></span>\r\n         </div>\r\n         <div class='slider-controller'>\r\n            <label>min</label>:<span class=\"math-field min\">-5</span>\r\n            <label>max</label>:<span class=\"math-field max\">5</span>\r\n            <label>step</label>:<span class=\"math-field step\">0.1</span>\r\n         </div>\r\n      </div>`);\r\n      this.elt.querySelector('.main').append(sliderOuter[0]);\r\n      let slider = sliderOuter[0].querySelector('.slider');\r\n\r\n      slider.addEventListener('change', () => {\r\n         if (this.specialProps.invokeOnchange) {\r\n            this.graphChild.setValue(parseFloat(slider.value), [false]);\r\n            this.setScript(this.graphChild.id + ' = ' + slider.value, false);\r\n            if (this.isError) {\r\n               /// Math.${id} is undefined so setValue first\r\n               this.isError = false;\r\n               this.__updateDependants();\r\n               this.elt.querySelector('.error-elt').remove();\r\n            }\r\n         }\r\n      });\r\n      $(slider).on('mousemove touchmove', () => {\r\n         if (slider.ismousedown) {\r\n            this.graphChild.setValue(parseFloat(slider.value));\r\n            this.setScript(this.graphChild.id + ' = ' + slider.value, false);\r\n            if (this.isError) {\r\n               /// Math.${id} is undefined so setValue first\r\n               this.isError = false;\r\n               this.__updateDependants();\r\n               this.elt.querySelector('.error-elt').remove();\r\n            }\r\n         }\r\n      });\r\n      $(slider).on('mousedown touchstart', () => {\r\n         slider.ismousedown = true;\r\n      });\r\n      $(slider).on('mouseup touchend', () => {\r\n         slider.ismousedown = false;\r\n      });\r\n\r\n      // sliderControllerMathFields\r\n      let scmfs = {\r\n         min: MQ.MathField(sliderOuter[0].querySelector('.slider-controller .math-field.min'), {\r\n            handlers: {\r\n               edit: function () {\r\n                  slider.min = (MathPackage.Parser.maximaTOjsFunction(MathPackage.Parser.latexTOmaxima(scmfs.min.latex())).func)();\r\n               }\r\n            }\r\n         }),\r\n         max: MQ.MathField(sliderOuter[0].querySelector('.slider-controller .math-field.max'), {\r\n            handlers: {\r\n               edit: function () {\r\n                  slider.max = (MathPackage.Parser.maximaTOjsFunction(MathPackage.Parser.latexTOmaxima(scmfs.max.latex())).func)();\r\n               }\r\n            }\r\n         }),\r\n         step: MQ.MathField(sliderOuter[0].querySelector('.slider-controller .math-field.step'), {\r\n            handlers: {\r\n               edit: function () {\r\n                  slider.step = Math.max(0.01, MathPackage.Parser.maximaTOjsFunction(MathPackage.Parser.latexTOmaxima(scmfs.step.latex()).func)());\r\n               }\r\n            }\r\n         })\r\n      };\r\n\r\n      /// the special properties for this specific type of GraphChild\r\n      this.specialProps = {\r\n         slider, scmfs,\r\n         invokeOnchange: true\r\n      };\r\n\r\n      this.__updateSlider();\r\n   }\r\n\r\n   __updateSlider() {\r\n      this.graphChild.handlers.onchange = (updateSlider = true) => {\r\n         if (updateSlider)\r\n            slider.value = this.graphChild.getValue();\r\n         mySketch.update(true, false);\r\n      };\r\n\r\n      let slider = this.specialProps.slider;\r\n      let value = this.graphChild.getValue();\r\n\r\n\r\n      this.specialProps.scmfs.min.latex(Math.min(parseFloat(slider.min), parseFloat(value)));\r\n      this.specialProps.scmfs.max.latex(Math.max(parseFloat(slider.max), parseFloat(value)));\r\n\r\n      this.specialProps.invokeOnchange = false;\r\n      slider.value = value;\r\n      this.specialProps.invokeOnchange = true;\r\n\r\n      // this.setScript(this.graphChild.id + ' = ' + slider.value, false);\r\n   }\r\n\r\n   __toConstant() {\r\n      let eltsTOremove = this.elt.querySelectorAll('.special-elt');\r\n      eltsTOremove.forEach(elt => { elt.remove(); });\r\n\r\n      this.specialProps = {};\r\n\r\n      // this.__updateEvalExpr(); /// will be done on updating the sktech\r\n   }\r\n\r\n   __updateConstant() {\r\n\r\n   }\r\n   //#endregion\r\n\r\n}","import ChildControl from './ChildControl.js';\r\nimport Sketch from '../PLOTTO/Sketch.js';\r\n\r\n//#region variables\r\nexport var subTools = {\r\n   details: SUI.TempMessege({\r\n      layer: false,\r\n      toolsbar: true,\r\n      onhoverFix: true,\r\n      position: { bottom: 20, left: 20 },\r\n      duration: 2500, // to make it fixed\r\n      content: '<p style=\"background: green; color:white;\">There is no god but Allah',\r\n      parent: document.querySelector('#canvas-parent').parentElement,\r\n   })\r\n};\r\nexport var mouse = { x: undefined, y: undefined };\r\n\r\nexport var keypadSettings = {\r\n   backspaceInterval: undefined,\r\n   mouseDownForInterval: false,\r\n   showHideKeyBtn: document.querySelector(\".sh-keypad\"),\r\n   mathField: document.querySelector('.script')\r\n};\r\n\r\nexport var sidebar = document.querySelector('.sidebar-container');\r\n\r\n//#endregion\r\n\r\n//#region methods\r\n\r\nexport function updateObjsOrder() {\r\n   let objs = document.querySelectorAll('.controls li');\r\n   let order = 1;\r\n   for (let obj of objs) {\r\n      obj.setAttribute('index', order - 1);\r\n      obj.querySelector('.order').textContent = order++;\r\n   }\r\n}\r\n\r\nexport function addControl(input, index = 'last', autoFocus = true) {\r\n   let control = input;\r\n   if ((typeof input).toLowerCase() === 'string') {\r\n      control = new ChildControl();\r\n      control.mathField.latex(input);\r\n   }\r\n   var controls = document.querySelector('.controls');\r\n   index = (math.isNumeric(index) && index > controls.childElementCount - 1) ? 'last' : index;\r\n   let i = index === 'last' ? controls.childElementCount - 1 : index;\r\n   if (i > -1 && index !== 'last') {\r\n      control.elt.querySelector('.order').textContent = i + 1;\r\n      controls.insertBefore(control.elt, controls.children[i]);\r\n      updateObjsOrder();\r\n   } else {\r\n      control.elt.setAttribute('index', controls.childElementCount);\r\n      control.elt.querySelector('.order').textContent = controls.childElementCount + 1;\r\n      controls.appendChild(control.elt);\r\n   }\r\n   if (autoFocus) control.focus();\r\n\r\n}\r\n\r\nexport function removeControl(control) {\r\n   if (control === keypadSettings.focusedControl) {\r\n      let alter = control.elt.previousElementSibling || control.elt.nextElementSibling;\r\n      if (alter) {\r\n         mySketch.children.get(alter.getAttribute('id')).control.focus();\r\n      }\r\n   }\r\n   control.elt.remove();\r\n   var controls = document.querySelector('.controls');\r\n   var newControlBtn = controls.parentElement.querySelector('#add-new-control');\r\n   if (controls.childElementCount === 0) {\r\n      newControlBtn.classList.add('animate-shake');\r\n      controls.parentElement.classList.add('blink-error');\r\n      setTimeout(() => {\r\n         newControlBtn.classList.remove('animate-shake');\r\n         controls.parentElement.classList.remove('blink-error');\r\n         addControl(new ChildControl());\r\n      }, 400);\r\n   }\r\n}\r\n\r\nexport function addTOsketch(child, controlIndex = 'last' /* the index */) {\r\n   if ((controlIndex || controlIndex === 0) && !child.control) {\r\n      let control = new ChildControl(child);\r\n      addControl(control, controlIndex);\r\n   }\r\n   mySketch.appendChild(child);\r\n}\r\n\r\nexport function resize(setContainment = true) {\r\n   checkSM();\r\n\r\n   let appMainContainer = document.querySelector('.app-container .container');\r\n   appMainContainer.setAttribute('style', appMainContainer.getAttribute('style').replace(/--app-main-(width|height)\\s*:\\s*(.*?)($|;)/g, (match, dimension) => {\r\n      return dimension ? `--app-main-width: ${appMainContainer.clientWidth}px;` : `--app-main-height: ${appMainContainer.clientHeight}px;`;\r\n   }));\r\n   \r\n   sidebar.setAttribute('style', sidebar.getAttribute('style').replace(/--sb-(width|height)\\s*:\\s*(.*?)($|;)/g, (match, dimension) => {\r\n      return dimension ? `--sb-width: ${sidebar.clientWidth}px;` : `--sb-height: ${sidebar.clientHeight}px;`;\r\n   }));\r\n\r\n   mySketch.canvas.resize(canvasParent.clientWidth, canvasParent.clientHeight);\r\n   mySketch.childrenCanvas.resize(canvasParent.clientWidth, canvasParent.clientHeight);\r\n\r\n   mySketch.gs.transform.invokeOnchange = false;\r\n\r\n   mySketch.gs.width = canvasParent.clientWidth;\r\n   mySketch.gs.height = canvasParent.clientHeight;\r\n\r\n   let vp = mySketch.gs.viewport;\r\n   mySketch.gs.transform.onchange(true);\r\n   // if (angles.minAngle(new vector(1, 0), vector.fromAngle(mySketch.gs.transform.xAngle)).toFixed(3) === (0).toFixed(3) && angles.minAngle(new vector(1, 0), vector.fromAngle(mySketch.gs.transform.yAngle)).toFixed(3) === (Math.PI / 2).toFixed(3)) {\r\n   mySketch.gs.transform.transformOrigin = undefined;\r\n   mySketch.gs.transform.setViewport(vp, true);\r\n   mySketch.gs.transform.invokeOnchange = true;\r\n   mySketch.gs.transform.onchange();\r\n   // }\r\n\r\n   if (setContainment) {\r\n      $(\".resizer\", sidebar)\r\n         .draggable('option', 'containment', getContainment(sidebar));\r\n      // .css({ left: document.querySelector('.sidebar-container').clientWidth + 'px' });\r\n   }\r\n\r\n   mySketch.update();\r\n   resize.prevSize = { width: window.innerWidth, height: window.innerHeight };\r\n}\r\nexport function checkSM() {\r\n   if (window.innerWidth <= 600 && resize.prevSize.width > 600) {\r\n      /// changing the element layout\r\n      document.body.querySelector('.app-container').classList.remove('large-screen');\r\n      document.body.querySelector('.app-container').classList.add('small-screen');\r\n   } else if (window.innerWidth > 600 && resize.prevSize.width <= 600) {\r\n      /// changing the element layout\r\n      document.body.querySelector('.app-container').classList.add('large-screen');\r\n      document.body.querySelector('.app-container').classList.remove('small-screen');\r\n   }\r\n}\r\ncheckSM.prevSize = { width: window.innerWidth, height: window.innerHeight };\r\n\r\nexport function getContainment(elt) {\r\n   let sidebarStyle = window.getComputedStyle(elt);\r\n   let min = parseInt(sidebarStyle.minWidth.replace('px', '')),\r\n      max = parseInt(sidebarStyle.maxWidth.replace('px', ''));\r\n   /// this is for solving the problem when the max width 30%vw is lower than the min width 300px,\r\n   ///   - which cuase a problem with the position (style.left) of the resizer. \r\n   if (min > max) {\r\n      return [\r\n         min, 0,\r\n         min,\r\n         parseInt(sidebarStyle.height.replace('px', ''))\r\n      ];\r\n   } else {\r\n      return [\r\n         min, 0,\r\n         max,\r\n         parseInt(sidebarStyle.height.replace('px', ''))\r\n      ];\r\n   }\r\n\r\n}\r\nexport function genRandomName() {\r\n   let num = 0;\r\n   /// randomNameNum is here to avoid getting the same random name if the code is implemented so fast\r\n\r\n   return (Date.now() + genRandomName.randomNameNum++)\r\n      .toString(36)\r\n      .replace(/\\d/g, (num) => {\r\n         return String.fromCharCode(97 + parseInt(num));\r\n      });\r\n}\r\ngenRandomName.randomNameNum = 0;\r\n\r\nexport function hassClass(elt, c) {\r\n   for (let _c of elt.classList){\r\n      if (c === _c) return true;\r\n   }\r\n   return false;\r\n}\r\n//#endregion\r\n","export default class {\r\n\r\n   constructor(gs) {\r\n      this.gs = gs;\r\n      this.coorManager = gs.coorManager;\r\n      this.handlers = {};\r\n      \r\n      this.angleMargin = angles.deg(20);\r\n      this.zoomLimits = [80, 180];\r\n      this.zoomLimits[1] = (this.zoomLimits[1] * 2 / 5) < this.zoomLimits[0] ? this.zoomLimits[0] * 5 / 2 + 1 : this.zoomLimits[0];\r\n      this.zoomRatio = 1.1;\r\n\r\n      this.invokeOnchange = true;\r\n      this.reset();\r\n   }\r\n\r\n   /**\r\n    * @returns the i vector of the cartesian coordinates relative to (with respect to) the pixel coordinates\r\n    */\r\n   get iVector() {\r\n      return vector.fromAngle(-this.xAngle).mult(this.xScale);\r\n   }\r\n   /**\r\n   * @returns the j vector of the cartesian coordinates relative to (with respect to) the pixel coordinates\r\n   */\r\n   get jVector() {\r\n      return vector.fromAngle(-this.yAngle).mult(this.yScale);\r\n   }\r\n\r\n   getTransform() {\r\n      let i = this.iVector;\r\n      let j = this.jVector;\r\n      let c = this.center;\r\n      return { a: i.x, b: i.y, c: j.x, d: j.y, e: c.x, f: c.y };\r\n   }\r\n\r\n   //#region transformation's origin\r\n\r\n   get transformOrigin() {\r\n      return this._transformOrigin;\r\n   }\r\n\r\n   set transformOrigin(pxVector) {\r\n      if (pxVector && pxVector instanceof vector) {\r\n         this._transformOrigin = {\r\n            pxVector: pxVector\r\n         };\r\n         let coor = this.coorManager.pxTOcoor(pxVector.x, pxVector.y);\r\n         this._transformOrigin.coorVector = new vector(coor.x, coor.y);\r\n      } else {\r\n         this._transformOrigin = undefined;\r\n      }\r\n   }\r\n\r\n   //#endregion\r\n\r\n   //#region {rotation, angles}\r\n\r\n   get xAngle() { return this._xAngle; }\r\n   set xAngle(v) {\r\n      let a = angles.constrainAngle(v);\r\n      if (angles.minAngle(vector.fromAngle(a), vector.fromAngle(this._yAngle), { type: 'lines' }) < this.angleMargin) {\r\n         let b = angles.angle(vector.fromAngle(a), vector.fromAngle(this._yAngle), { dir: 'clockwise' });\r\n         if (b < this.angleMargin && b > 0) {\r\n            a = angles.constrainAngle(this._yAngle + this.angleMargin);\r\n         }\r\n         else {\r\n            b = angles.angle(vector.fromAngle(a), vector.fromAngle(this._yAngle));\r\n            if (b < this.angleMargin && b > 0) {\r\n               a = angles.constrainAngle(this._yAngle - this.angleMargin);\r\n            }\r\n            else {\r\n               b = angles.angle(vector.fromAngle(a), vector.fromAngle(this._yAngle).mult(-1), { dir: 'clockwise' });\r\n               if (b < this.angleMargin && b > 0) {\r\n                  a = angles.constrainAngle(this._yAngle + Math.PI + this.angleMargin);\r\n               }\r\n               else {\r\n                  b = angles.angle(vector.fromAngle(a), vector.fromAngle(this._yAngle).mult(-1));\r\n                  if (b < this.angleMargin && b > 0) {\r\n                     a = angles.constrainAngle(this._yAngle + Math.PI - this.angleMargin);\r\n                  }\r\n               }\r\n            }\r\n         }\r\n      }\r\n      this._xAngle = a;\r\n   }\r\n\r\n   get yAngle() { return this._yAngle; }\r\n   set yAngle(v) {\r\n      let a = angles.constrainAngle(v);\r\n      if (angles.minAngle(vector.fromAngle(a), vector.fromAngle(this._xAngle), { type: 'lines' }) < this.angleMargin) {\r\n         let b = angles.angle(vector.fromAngle(a), vector.fromAngle(this._xAngle), { dir: 'clockwise' });\r\n         if (b < this.angleMargin && b > 0) {\r\n            a = angles.constrainAngle(this._xAngle + this.angleMargin);\r\n         }\r\n         else {\r\n            b = angles.angle(vector.fromAngle(a), vector.fromAngle(this._xAngle));\r\n            if (b < this.angleMargin && b > 0) {\r\n               a = angles.constrainAngle(this._xAngle - this.angleMargin);\r\n            }\r\n            else {\r\n               b = angles.angle(vector.fromAngle(a), vector.fromAngle(this._xAngle).mult(-1), { dir: 'clockwise' });\r\n               if (b < this.angleMargin && b > 0) {\r\n                  a = angles.constrainAngle(this._xAngle + Math.PI + this.angleMargin);\r\n               }\r\n               else {\r\n                  b = angles.angle(vector.fromAngle(a), vector.fromAngle(this._xAngle).mult(-1));\r\n                  if (b < this.angleMargin && b > 0) {\r\n                     a = angles.constrainAngle(this._xAngle + Math.PI - this.angleMargin);\r\n                  }\r\n               }\r\n            }\r\n         }\r\n      }\r\n      this._yAngle = a;\r\n   }\r\n\r\n   /**\r\n * @param {*} type, is 'deg' or 'rad'\r\n */\r\n   rotate(a, type = 'rad') {\r\n      if (!isNaN(a)) {\r\n         if (type === 'deg') {\r\n            a = a / 180 * Math.PI;\r\n         }\r\n         let i = this.invokeOnchange;\r\n         this.invokeOnchange = false;\r\n         this.xAngle += a;\r\n         this.yAngle += a;\r\n         this.invokeOnchange = i;\r\n         this.onchange();\r\n      }\r\n   }\r\n\r\n   /**\r\n  * @param {*} type, is 'deg' or 'rad'\r\n  */\r\n   rotateX(a, type = 'rad') {\r\n      if (!isNaN(a)) {\r\n         if (type === 'deg') {\r\n            a = a / 180 * Math.PI;\r\n         }\r\n         let i = this.invokeOnchange;\r\n         this.invokeOnchange = false;\r\n         this.xAngle += a;\r\n         this.invokeOnchange = i;\r\n         this.onchange();\r\n      }\r\n   }\r\n\r\n   /**\r\n    * @param {*} type, is 'deg' or 'rad'\r\n    */\r\n   rotateY(a, type = 'rad') {\r\n      if (!isNaN(a)) {\r\n         this.invokeOnchange = false;\r\n         if (type === 'deg') {\r\n            a = a / 180 * Math.PI;\r\n         }\r\n         let i = this.invokeOnchange;\r\n         this.invokeOnchange = false;\r\n         this.yAngle += a;\r\n         this.invokeOnchange = i;\r\n         this.onchange();\r\n      }\r\n   }\r\n\r\n   //#endregion\r\n\r\n   //#region translate\r\n\r\n   get center() { return this._center; }\r\n\r\n   set center(vec) {\r\n      this._center = vec;\r\n      this.onchange(this.invokeOnchange, false);\r\n   }\r\n\r\n   translate(value) {\r\n      this.center = new vector(this._center.x + value.x, this._center.y + value.y);\r\n   }\r\n\r\n   //#endregion\r\n\r\n   //#region zoom\r\n\r\n   zoomIn(centerOfZoom) {\r\n\r\n      centerOfZoom = centerOfZoom || new vector(this.gs.width / 2, this.gs.height / 2);\r\n      this.transformOrigin = centerOfZoom;\r\n\r\n      let a = this.invokeOnchange;\r\n      this.invokeOnchange = false;\r\n      this.xZoomIn(); this.yZoomIn();\r\n      this.invokeOnchange = a;\r\n      this.onchange();\r\n\r\n   }\r\n   zoomOut(centerOfZoom) {\r\n\r\n      centerOfZoom = centerOfZoom || new vector(this.gs.width / 2, this.gs.height / 2);\r\n      this.transformOrigin = centerOfZoom;\r\n\r\n      let a = this.invokeOnchange;\r\n      this.invokeOnchange = false;\r\n      this.xZoomOut(); this.yZoomOut();\r\n      this.invokeOnchange = a;\r\n      this.onchange();\r\n\r\n   }\r\n   xZoomIn() {\r\n      // #region X\r\n      if (this.xSpace <= this.zoomLimits[1]) this.xSpace *= this.zoomRatio;\r\n\r\n      this.reformXspace();\r\n      this.onchange();\r\n      //#endregion\r\n   }\r\n   xZoomOut() {\r\n      // #region X\r\n      if (this.xSpace >= this.zoomLimits[0]) this.xSpace /= this.zoomRatio;\r\n\r\n      this.reformXspace();\r\n      this.onchange();\r\n      //#endregion\r\n\r\n   }\r\n   yZoomIn() {\r\n      // #region Y\r\n      if (this.ySpace <= this.zoomLimits[1]) this.ySpace *= this.zoomRatio;\r\n\r\n      this.reformYspace();\r\n      this.onchange();\r\n      //#endregion\r\n   }\r\n   yZoomOut() {\r\n      // #region Y\r\n      if (this.ySpace >= this.zoomLimits[0]) this.ySpace /= this.zoomRatio;\r\n\r\n      this.reformYspace();\r\n      this.onchange();\r\n      //#endregion\r\n   }\r\n\r\n   //#endregion\r\n\r\n   //#region viewport managment\r\n\r\n   /**\r\n    * setting new viewport form the cartesian coordinates.\r\n    * @param {Object} viewport \r\n    * an object has: 1. xmin, xmax, ymin, ymax representing the edges of the cartesian coordinates not the pixels in the canvas\r\n    * @param {Object} keepRatio \r\n    */\r\n   setViewport(viewport, keepRatio) {\r\n      //#region precalculations\r\n      // the top left corner\r\n      viewport.xmin = viewport.xmin === 0 ? 0 : (viewport.xmin || this.gs.viewport.xmin);\r\n      viewport.xmax = viewport.xmax === 0 ? 0 : (viewport.xmax || this.gs.viewport.xmax);\r\n      viewport.ymin = viewport.ymin === 0 ? 0 : (viewport.ymin || this.gs.viewport.ymin);\r\n      viewport.ymax = viewport.ymax === 0 ? 0 : (viewport.ymax || this.gs.viewport.ymax);\r\n      let a = this.invokeOnchange; this.invokeOnchange = false;\r\n      let p = this.coorManager.pxTOcoor(this.gs.width / 2, this.gs.height / 2);\r\n\r\n      //#endregion\r\n\r\n      //#region maincalculations\r\n      let xs = this.xSpace, ys = this.ySpace;\r\n\r\n      this.xSpace = this.xSpace / ((viewport.xmax - viewport.xmin) / (this.gs.viewport.xmax - this.gs.viewport.xmin));\r\n      if (keepRatio) {\r\n         this.ySpace *= this.xSpace / xs;\r\n      } else {\r\n         this.ySpace = this.ySpace / ((viewport.ymax - viewport.ymin) / (this.gs.viewport.ymax - this.gs.viewport.ymin));\r\n      }\r\n\r\n      if (this.ySpace <= 0 || this.xSpace <= 0 || isNaN(this.xSpace) || !isFinite(this.xSpace) || isNaN(this.ySpace) || !isFinite(this.ySpace)) {\r\n         this.xSpace = xs;\r\n         this.ySpace = ys;\r\n      }\r\n\r\n      this.reformXspace();\r\n      this.reformYspace();\r\n\r\n      //#endregion\r\n\r\n      //#region aftercalulations\r\n\r\n      this.onchange(true);\r\n      let tfCorner = this.coorManager.coorTOpx(viewport.xmin, viewport.ymax);\r\n      tfCorner = new vector(tfCorner.x, tfCorner.y);\r\n      /// translation::: put the top left corner as pixels after transformations on top of the one before transformation \r\n      this.translate(tfCorner.mult(-1));\r\n      this.onchange(true);\r\n      if (keepRatio) {\r\n         let p_ = this.coorManager.coorTOpx(p.x, (viewport.ymax + viewport.ymin) / 2);\r\n         this.translate(new vector(0, this.gs.height / 2 - p_.y));\r\n      }\r\n      this.onchange(); this.invokeOnchange = a;\r\n      //#endregion\r\n   }\r\n\r\n   getViewport(pxViewport) {\r\n      pxViewport.xmin = pxViewport.xmin || 0;\r\n      pxViewport.xmax = pxViewport.xmax || this.gs.width;\r\n      pxViewport.ymin = pxViewport.ymin || 0;\r\n      pxViewport.ymax = pxViewport.ymax || this.gs.height;\r\n\r\n      let xStart = this.coorManager.xTOcoor(pxViewport.xmin, Math.tan(this.yAngle) > 0 ? pxViewport.ymin : pxViewport.ymax);\r\n      let xEnd = this.coorManager.xTOcoor(pxViewport.xmax, Math.tan(this.yAngle) <= 0 ? pxViewport.ymin : pxViewport.ymax);\r\n      let yStart = this.coorManager.yTOcoor(Math.tan(this.xAngle) > 0 ? pxViewport.xmax : pxViewport.xmin, pxViewport.ymax);\r\n      let yEnd = this.coorManager.yTOcoor(Math.tan(this.xAngle) <= 0 ? pxViewport.xmax : pxViewport.xmin, pxViewport.ymin);\r\n\r\n      return {\r\n         xmin: xEnd < xStart ? xEnd : xStart,\r\n         xmax: xEnd > xStart ? xEnd : xStart,\r\n         ymin: yEnd < yStart ? yEnd : yStart,\r\n         ymax: yEnd > yStart ? yEnd : yStart\r\n      };\r\n   }\r\n\r\n   //#endregion\r\n\r\n   //#region general\r\n\r\n   reformXspace() {\r\n      let done = false;\r\n      while (this.xSpace > this.zoomLimits[1]) {\r\n         if (this.xZoomingState == 5) {\r\n            this.xZoomingState = 2;\r\n            let ratio = 2 / 5;\r\n            this.xSpaceValue = this.xSpaceValue * ratio;\r\n            this.xSpace = this.xSpace * ratio;\r\n         }\r\n         else if (this.xZoomingState == 2) {\r\n            this.xZoomingState = 1;\r\n            let ratio = 1 / 2;\r\n            this.xSpaceValue = this.xSpaceValue * ratio;\r\n            this.xSpace = this.xSpace * ratio;\r\n         }\r\n         else if (this.xZoomingState == 1) {\r\n            this.xZoomingState = 5;\r\n            let ratio = 0.5 / 1;\r\n            this.xSpaceValue = this.xSpaceValue * ratio;\r\n            this.xSpace = this.xSpace * ratio;\r\n         }\r\n         done = true;\r\n      }\r\n      if (done) return;\r\n      while (this.xSpace < this.zoomLimits[0]) {\r\n         if (this.xZoomingState == 1) {\r\n            this.xZoomingState = 2;\r\n            let ratio = 2 / 1;\r\n            this.xSpaceValue = this.xSpaceValue * ratio;\r\n            this.xSpace = this.xSpace * ratio;\r\n         }\r\n         else if (this.xZoomingState == 2) {\r\n            this.xZoomingState = 5;\r\n            let ratio = 5 / 2;\r\n            this.xSpaceValue = this.xSpaceValue * ratio;\r\n            this.xSpace = this.xSpace * ratio;\r\n         }\r\n         else if (this.xZoomingState == 5) {\r\n            this.xZoomingState = 1;\r\n            let ratio = 10 / 5;\r\n            this.xSpaceValue = this.xSpaceValue * ratio;\r\n            this.xSpace = this.xSpace * ratio;\r\n         }\r\n      }\r\n   }\r\n   reformYspace() {\r\n      let done = false;\r\n      while (this.ySpace > this.zoomLimits[1]) {\r\n         if (this.yZoomingState == 5) {\r\n            this.yZoomingState = 2;\r\n            let ratio = 2 / 5;\r\n            this.ySpaceValue = this.ySpaceValue * ratio;\r\n            this.ySpace = this.ySpace * ratio;\r\n         }\r\n         else if (this.yZoomingState == 2) {\r\n            this.yZoomingState = 1;\r\n            let ratio = 1 / 2;\r\n            this.ySpaceValue = this.ySpaceValue * ratio;\r\n            this.ySpace = this.ySpace * ratio;\r\n         }\r\n         else if (this.yZoomingState == 1) {\r\n            this.yZoomingState = 5;\r\n            let ratio = 0.5 / 1;\r\n            this.ySpaceValue = this.ySpaceValue * ratio;\r\n            this.ySpace = this.ySpace * ratio;\r\n         }\r\n         done = true;\r\n      }\r\n      if (done) return;\r\n      while (this.ySpace < this.zoomLimits[0]) {\r\n         if (this.yZoomingState == 1) {\r\n            this.yZoomingState = 2;\r\n            let ratio = 2 / 1;\r\n            this.ySpaceValue = this.ySpaceValue * ratio;\r\n            this.ySpace = this.ySpace * ratio;\r\n         }\r\n         else if (this.yZoomingState == 2) {\r\n            this.yZoomingState = 5;\r\n            let ratio = 5 / 2;\r\n            this.ySpaceValue = this.ySpaceValue * ratio;\r\n            this.ySpace = this.ySpace * ratio;\r\n         }\r\n         else if (this.yZoomingState == 5) {\r\n            this.yZoomingState = 1;\r\n            let ratio = 10 / 5;\r\n            this.ySpaceValue = this.ySpaceValue * ratio;\r\n            this.ySpace = this.ySpace * ratio;\r\n         }\r\n      }\r\n   }\r\n\r\n   reset() {\r\n      this.transformOrigin = undefined;\r\n\r\n      this.xSpace = 120;\r\n      this.xSpaceValue = 2;\r\n      this.xSpaceModifier = 1;\r\n      this.xZoomingState = 2;\r\n\r\n      this.ySpace = 120;\r\n      this.ySpaceValue = 2;\r\n      this.ySpaceModifier = 1;\r\n      this.yZoomingState = 2;\r\n\r\n      this._xAngle = 0;\r\n      this._yAngle = Math.PI / 2;\r\n\r\n      this._center = new vector(this.gs.width / 2, this.gs.height / 2);\r\n\r\n      this.onchange();\r\n   }\r\n\r\n   assign(target, src) {\r\n      // target._transformOrigin = src._transformOrigin;\r\n\r\n      target.xSpace = src.xSpace;\r\n      target.xSpaceValue = src.xSpaceValue;\r\n      target.xSpaceModifier = src.xSpaceModifier;\r\n      target.xZoomingState = src.xZoomingState;\r\n\r\n      target.ySpace = src.ySpace;\r\n      target.ySpaceValue = src.ySpaceValue;\r\n      target.ySpaceModifier = src.ySpaceModifier;\r\n      target.yZoomingState = src.yZoomingState;\r\n\r\n      target._xAngle = src._xAngle;\r\n      target._yAngle = src._yAngle;\r\n\r\n      target._center = src._center;\r\n   }\r\n\r\n   onchange(change = this.invokeOnchange, transToOrigin = true) {\r\n      /// updating\r\n      if (change) {\r\n\r\n         let ysm = this.xSpaceModifier + Math.abs(Math.cos(this.xAngle - this.yAngle));\r\n         let xsm = this.ySpaceModifier + Math.abs(Math.cos(this.xAngle - this.yAngle));\r\n         this.xScale = (this.xSpace * ysm / this.xSpaceValue);\r\n         this.yScale = (this.ySpace * xsm / this.ySpaceValue);\r\n\r\n         let invalid =\r\n            !math.isNumeric(this.xScale) || !math.isNumeric(this.yScale) ||\r\n            !math.isNumeric(this.center.x) || !math.isNumeric(this.center.y) ||\r\n            (this.transformOrigin && transToOrigin &&\r\n               (!math.isNumeric(this.transformOrigin.coorVector.x) || !math.isNumeric(this.transformOrigin.coorVector.y) ||\r\n                  !math.isNumeric(this.transformOrigin.pxVector.x) || !math.isNumeric(this.transformOrigin.pxVector.y)));\r\n\r\n         if (invalid) {\r\n            let a = this.invokeOnchange;\r\n            this.invokeOnchange = false;\r\n            try {\r\n               this.assign(this, this.lastVersion.transform);\r\n            } catch (e) {\r\n               this.reset();\r\n            }\r\n            this.invokeOnchange = a;\r\n            this.onchange(true);\r\n            return;\r\n         }\r\n\r\n         this.coorManager.transform = this.getTransform();\r\n\r\n         let vp = this.getViewport({\r\n            xmin: 0, xmax: this.gs.width,\r\n            ymin: 0, ymax: this.gs.height\r\n         });\r\n\r\n         vp.width = vp.xmax - vp.xmin;\r\n         vp.height = vp.ymax - vp.ymin;\r\n         this.gs.viewport = vp;\r\n\r\n         this.gs.drawingStep = (this.gs.viewport.xmax - this.gs.viewport.xmin) / 10000;\r\n\r\n         invalid = !math.isNumeric(this.gs.viewport.xmin) || !math.isNumeric(this.gs.viewport.xmax) ||\r\n            !math.isNumeric(this.gs.viewport.ymin) || !math.isNumeric(this.gs.viewport.ymax) ||\r\n            !math.isNumeric(this.gs.drawingStep) ||\r\n            (this.gs.viewport.xmax - this.gs.viewport.xmin) > 10 ** 12 ||\r\n            (this.gs.viewport.ymax - this.gs.viewport.ymin) > 10 ** 12 ||\r\n            (this.gs.viewport.xmax - this.gs.viewport.xmin) < 10 ** -12 ||\r\n            (this.gs.viewport.ymax - this.gs.viewport.ymin) < 10 ** -12 ||\r\n            (this.gs.viewport.xmin + this.gs.drawingStep / 2 <= this.gs.viewport.xmin) ||\r\n            this.gs.viewport.xmax - this.gs.drawingStep / 2 >= this.gs.viewport.xmax;\r\n\r\n         if (invalid && this.lastVersion) {\r\n            let a = this.invokeOnchange;\r\n            this.invokeOnchange = false;\r\n            try {\r\n               this.assign(this, this.lastVersion.transform);\r\n            } catch (e) {\r\n               this.reset();\r\n            }\r\n            this.invokeOnchange = a;\r\n            this.onchange(true);\r\n            return;\r\n         } else {\r\n\r\n            if (this.transformOrigin && transToOrigin) {\r\n               let a = this.invokeOnchange;\r\n               this.invokeOnchange = false;\r\n               let p = this.coorManager.coorTOpx(...this.transformOrigin.coorVector.toArray());\r\n               this.translate(this.transformOrigin.pxVector.subtract(p));\r\n               this.onchange(true, false);\r\n               this.invokeOnchange = a;\r\n               return;\r\n            }\r\n\r\n            if (this.handlers.onchange) {\r\n               this.handlers.onchange();\r\n            }\r\n            let trans = {};\r\n            this.assign(trans, this);\r\n            this.lastVersion = {\r\n               transform: trans,\r\n            };\r\n         }\r\n\r\n      }\r\n   }\r\n\r\n   //#endregion\r\n\r\n}\r\n","export default class CoorManager {\r\n\r\n   constructor(transform) {\r\n      this.transform = transform || {a: 1, b: 0, c: 0, d: 1, e: 0, f: 0};\r\n   }\r\n\r\n   get transform() {\r\n      return this.trans;\r\n   }\r\n\r\n   set transform(trans) {\r\n\r\n      this.e = trans.e;\r\n      this.f = trans.f;\r\n\r\n      this.a = trans.a;\r\n      this.b = trans.b;\r\n      this.c = trans.c;\r\n      this.d = trans.d;\r\n\r\n      let matrixInverse = (m) => {\r\n         let i = {};\r\n         let det = m.a * m.d - m.c * m.b;\r\n         i.a = m.d / det;\r\n         i.d = m.a / det;\r\n         i.c = -m.c / det;\r\n         i.b = -m.b / det;\r\n         return i;\r\n      };\r\n\r\n      let inverse = matrixInverse(trans);\r\n\r\n      this.ia = inverse.a;\r\n      this.ib = inverse.b;\r\n      this.ic = inverse.c;\r\n      this.id = inverse.d;\r\n   }\r\n\r\n   coorTOpx(x, y) {\r\n      return { x: this.xToPixel(x, y), y: this.yToPixel(x, y) };\r\n   }\r\n   \r\n   pxTOcoor(x, y) {\r\n      return { x: this.xTOcoor(x, y), y: this.yTOcoor(x, y) };\r\n   }\r\n\r\n   xToPixel(x, y) {\r\n      /// x and y are cartesian coordiantes\r\n      return (this.a * x + this.c * y + this.e);\r\n   }\r\n\r\n   yToPixel(x, y) {\r\n      /// x and y are cartesian coordiantes\r\n      return (this.b * x + this.d * y + this.f);\r\n   }\r\n\r\n   xTOcoor(x, y) {\r\n      x = x - this.e;\r\n      y = y - this.f;\r\n      return this.ia * x + this.ic * y;\r\n   }\r\n\r\n   yTOcoor(x, y) {\r\n      x = x - this.e;\r\n      y = y - this.f;\r\n      return this.ib * x + this.id * y;\r\n   }\r\n   \r\n}","import Transform from './Transform.js';\r\nimport CoorManager from './CoorManager.js';\r\nimport { ExistBefore } from '../Errors/index.js';\r\n\r\nexport default class {\r\n\r\n  constructor(sketch, width, height) {\r\n    this.sketch = sketch;\r\n    this._width = width;\r\n    this._height = height;\r\n\r\n    this.coorManager = new CoorManager();\r\n    this.transform = new Transform(this);\r\n\r\n    this.center = new vector(this.width / 2, this.height / 2);\r\n\r\n    this.physicsRun = false;\r\n\r\n  }\r\n\r\n  get coor() { return this.sketch.coor; }\r\n\r\n  get width() { return this._width || 0; }\r\n  set width(value) {\r\n    this._width = value; /** to update the boundaries */\r\n    this.transform.onchange();\r\n  }\r\n  get height() { return this._height || 0; }\r\n  set height(value) {\r\n    this._height = value; /** to update the boundaries */\r\n    this.transform.onchange();\r\n  }\r\n\r\n  get center() {\r\n    return this.transform.center;\r\n  }\r\n\r\n  set center(vec) {\r\n    this.transform.center = vec;\r\n  }\r\n\r\n  get iVector() {\r\n    return this.transform.iVector;\r\n  }\r\n\r\n  get jVector() {\r\n    return this.transform.jVector;\r\n  }\r\n\r\n  centrate() {\r\n    this.transform.center = new vector(this.width / 2, this.height / 2);\r\n  }\r\n\r\n  reset() {\r\n    this.transform.reset();\r\n  }\r\n\r\n  checkId(id) {\r\n    if (!id) throw new Error('can\\'t set a falsy value to the name of this sketch child.');\r\n    let __id = id.replace(/^\\s*([_a-zA-z]+\\d*)\\s*$/, '$1');\r\n    if (!__id)\r\n      throw new Error(`\"${id}\" is not valid to use.`);\r\n    else {\r\n      if (this.sketch.children.has(id)) {\r\n        throw new ExistBefore(id);\r\n      }\r\n    }\r\n    if (Math.hasOwnProperty(id)) throw new ExistBefore(id);\r\n    return __id;\r\n  }\r\n\r\n}\r\n\r\n\r\n","\r\nexport default class {\r\n\r\n   constructor(gs, coorSettings) {\r\n      this.gs = gs;\r\n      this.coorManager = this.gs.coorManager;\r\n      let defaultCoorSettings = {\r\n         type: 'default',\r\n         xUnit: '',\r\n         yUnit: '',\r\n\r\n         background: new drawing.color(255, 255, 255, 255),\r\n         font: 'Georgia',\r\n\r\n         drawDecimalLines: true,\r\n         drawMainLines: true,\r\n         drawAxisesLines: true,\r\n         drawPolarCircles: false,\r\n         drawPolarLines: false,\r\n         drawPolarAngles: false,\r\n         drawNumbers: true,\r\n\r\n         decimalLinesSpace: 5,\r\n         polarCirclesSpace: 5,\r\n         polarLinesAnglesSpace: 6,\r\n\r\n         penDecimalLines: null,\r\n         penMainLines: null,\r\n         penXaxis: null,\r\n         penYaxis: null,\r\n         penPolarCircles: null,\r\n         penPolarLines: null,\r\n\r\n         autoRefiningOnZoomimg: true\r\n      };\r\n\r\n      Object.assign(defaultCoorSettings, {\r\n         color: defaultCoorSettings.background.isDark() ? new drawing.color(200, 200, 200, 255) : new drawing.color(50, 50, 50, 1),\r\n         antiBackground: defaultCoorSettings.background.isDark() ? new drawing.color(200, 200, 200, 255) : new drawing.color(50, 50, 50, 1),\r\n         drawDecimalLines: !defaultCoorSettings.background.isDark(),\r\n         penDecimalLines: new drawing.pen(defaultCoorSettings.background.isDark() ? new drawing.color(200, 200, 200, 30 / 255) : new drawing.color(50, 50, 50, 30 / 255), 1),\r\n         penMainLines: new drawing.pen(defaultCoorSettings.background.isDark() ? new drawing.color(200, 200, 200, 100 / 255) : new drawing.color(50, 50, 50, 100 / 255), 1),\r\n         penXaxis: new drawing.pen(defaultCoorSettings.background.isDark() ? new drawing.color(255, 255, 255, 150 / 255) : new drawing.color(0, 0, 0, 150 / 255), 2),\r\n         penYaxis: new drawing.pen(defaultCoorSettings.background.isDark() ? new drawing.color(255, 255, 255, 150 / 255) : new drawing.color(0, 0, 0, 150 / 255), 2),\r\n         penPolarCircles: new drawing.pen(defaultCoorSettings.background.isDark() ? new drawing.color(200, 200, 200, 100 / 255) : new drawing.color(50, 50, 50, 50 / 255), 1),\r\n         penPolarLines: new drawing.pen(defaultCoorSettings.background.isDark() ? new drawing.color(200, 200, 200, 100 / 255) : new drawing.color(50, 50, 50, 50 / 255), 1)\r\n      });\r\n      Object.assign(defaultCoorSettings, {\r\n         fillColor: defaultCoorSettings.color.toString(),\r\n         fillColorDim: defaultCoorSettings.color.toString({ a: 0.5 }),\r\n      });\r\n      if (coorSettings) {\r\n         this.coorSettings = {};\r\n         Object.assign(this.coorSettings, defaultCoorSettings);\r\n         Object.assign(this.coorSettings, coorSettings);\r\n      } else {\r\n         this.coorSettings = defaultCoorSettings;\r\n      }\r\n\r\n   }\r\n\r\n   draw(ctx) {\r\n      switch (this.coorSettings.type) {\r\n         case 'default':\r\n            this.custom(ctx);\r\n            break;\r\n         case 'rad':\r\n            this.radian(ctx);\r\n            break;\r\n      }\r\n   }\r\n\r\n   custom(canvas, a = 1) {\r\n\r\n      let start_x, start_y, end_x, end_y;\r\n      start_x = Math.floor(this.gs.viewport.xmin / this.gs.transform.xSpaceValue / a) * a * this.gs.transform.xSpaceValue;\r\n      end_x = Math.ceil(this.gs.viewport.xmax / this.gs.transform.xSpaceValue / a) * a * this.gs.transform.xSpaceValue;\r\n      start_y = Math.floor(this.gs.viewport.ymin / this.gs.transform.ySpaceValue) * this.gs.transform.ySpaceValue;\r\n      end_y = Math.ceil(this.gs.viewport.ymax / this.gs.transform.ySpaceValue) * this.gs.transform.ySpaceValue;\r\n\r\n      if (this.coorSettings.drawDecimalLines) {\r\n         canvas.ctx.beginPath();\r\n         this.coorSettings.penDecimalLines.setup(canvas);\r\n         // x\r\n         for (let i = start_x; i <= end_x; i += this.gs.transform.xSpaceValue * a / this.coorSettings.decimalLinesSpace)\r\n            canvas.line(this.coorManager.xToPixel(i, start_y), this.coorManager.yToPixel(i, start_y),\r\n               this.coorManager.xToPixel(i, end_y), this.coorManager.yToPixel(i, end_y));\r\n         // y\r\n         for (let i = start_y; i <= end_y; i += this.gs.transform.ySpaceValue / this.coorSettings.decimalLinesSpace)\r\n            canvas.line(this.coorManager.xToPixel(start_x, i), this.coorManager.yToPixel(start_x, i),\r\n               this.coorManager.xToPixel(end_x, i), this.coorManager.yToPixel(end_x, i));\r\n         canvas.ctx.stroke();\r\n      }\r\n\r\n      if (this.coorSettings.drawMainLines) {\r\n         canvas.ctx.beginPath();\r\n         this.coorSettings.penMainLines.setup(canvas);\r\n         // x\r\n         for (let i = start_x; i <= end_x; i += this.gs.transform.xSpaceValue * a)\r\n            canvas.line(this.coorManager.xToPixel(i, start_y), this.coorManager.yToPixel(i, start_y),\r\n               this.coorManager.xToPixel(i, end_y), this.coorManager.yToPixel(i, end_y));\r\n         // y\r\n         for (let i = start_y; i <= end_y; i += this.gs.transform.ySpaceValue)\r\n            canvas.line(this.coorManager.xToPixel(start_x, i), this.coorManager.yToPixel(start_x, i),\r\n               this.coorManager.xToPixel(end_x, i), this.coorManager.yToPixel(end_x, i));\r\n         canvas.ctx.stroke();\r\n      }\r\n\r\n      if (this.coorSettings.drawAxisesLines) {\r\n         canvas.ctx.beginPath();\r\n         this.coorSettings.penXaxis.setup(canvas);\r\n         canvas.line(this.coorManager.xToPixel(start_x, 0), this.coorManager.yToPixel(start_x, 0),\r\n            this.coorManager.xToPixel(end_x, 0), this.coorManager.yToPixel(end_x, 0));\r\n         canvas.ctx.stroke();\r\n         canvas.ctx.beginPath();\r\n         this.coorSettings.penYaxis.setup(canvas);\r\n         canvas.line(this.coorManager.xToPixel(0, start_y), this.coorManager.yToPixel(0, start_y),\r\n            this.coorManager.xToPixel(0, end_y), this.coorManager.yToPixel(0, end_y));\r\n         canvas.ctx.stroke();\r\n      }\r\n\r\n      if (this.coorSettings.drawNumbers) {\r\n         start_x = Math.floor(start_x / this.gs.transform.xSpaceValue / a);\r\n         end_x = Math.ceil(end_x / this.gs.transform.xSpaceValue / a);\r\n         start_y = Math.floor(start_y / this.gs.transform.ySpaceValue);\r\n         end_y = Math.ceil(end_y / this.gs.transform.ySpaceValue);\r\n\r\n         let y, x;\r\n         let num;\r\n         // label position x\r\n         canvas.ctx.fillStyle = this.coorSettings.fillColor;\r\n         canvas.ctx.strokeStyle = this.coorSettings.background.toString();\r\n         canvas.ctx.lineWidth = 3;\r\n         canvas.setFont({ size: 15 }); /// setting the label style.\r\n\r\n         let xD, yD;\r\n         if (Math.abs(Math.tan(this.gs.transform.yAngle)) > Math.abs(Math.tan(this.gs.transform.xAngle))) { // && Math.tan(Math.abs(this.gs.transform._xAngle - this.gs.transform._yAngle)) >= 1\r\n            // dealing horizetally when setting x labels vetically.\r\n            xD = 'v'; yD = 'h';\r\n         }\r\n         else {\r\n            xD = 'h'; yD = 'v';\r\n         }\r\n\r\n         for (let i = start_x; i <= end_x; i += 1) {\r\n            x = i * this.gs.transform.xSpaceValue;\r\n            num = (Math.abs(x) < 0.001 || Math.abs(x) >= 999999) ?\r\n               x.toExponential(3).replace(/\\.?0+e\\+?/, '10^') :\r\n               x.toFixed(3).replace(/0+$/, \"\").replace(/\\.$/, ''); /// .toFixed(3) returns 32146.000 if you input an integer, so I want to remove all the zeros from the end, and if \".\" remians, then remove it too, other wise keep all thing such as 2343165.123 \r\n            if (x != 0) {\r\n               num += (a === Math.PI / 2 ? 'pi' : '') + this.coorSettings.xUnit;\r\n               let p = this.__getLabelPos(canvas, this.coorManager.coorTOpx(x, 0) , num, xD, this.gs.transform.jVector); /// position of the label of x which the line, which is parallel to yAxis, intersect xAxis;\r\n               canvas.ctx.strokeText(num, p.x, p.y);\r\n               canvas.ctx.fillText(num, p.x, p.y);\r\n            }\r\n         }\r\n         // label position y\r\n         for (let i = start_y; i <= end_y; i += 1) {\r\n            y = i * this.gs.transform.ySpaceValue;\r\n            num = (Math.abs(y) < 0.001 || Math.abs(y) >= 999999) ?\r\n               y.toExponential(3).replace(/\\.?0+e\\+?/, '10^') :\r\n               y.toFixed(3).replace(/0+$/, \"\").replace(/\\.$/, '');\r\n            if (y != 0) {\r\n               num += this.coorSettings.yUnit;\r\n               let p = this.__getLabelPos(canvas, this.coorManager.coorTOpx(0, y), num, yD, this.gs.transform.iVector);\r\n               canvas.ctx.strokeText(num, p.x, p.y);\r\n               canvas.ctx.fillText(num, p.x, p.y);\r\n            }\r\n         }\r\n      }\r\n   }\r\n   radian(canvas) {\r\n      this.custom(canvas, Math.PI / 2);\r\n   }\r\n\r\n   /**\r\n    * \r\n    * @param {vector} pos the real position for the label on either of the two axes\r\n    * @param {string} number as string to measure its size.\r\n    * @param {string} dimension which is either 'h' or 'v', so the code will check if the label is out side the horizental view 'h', or the vertical view 'v';\r\n    */\r\n   __getLabelPos(canvas, pos, number, dimension, unitVec) {\r\n      let size = canvas.measureString(number);\r\n      size.height = 10; // as there is no properity called height in size, gotten from measureString(\"string\");\r\n      pos = new vector(pos.x +4, pos.y +4);\r\n\r\n      if (dimension === 'h') {\r\n         let bounds = [10, this.gs.width - size.width - 10];\r\n         if (pos.x < bounds[0]) {\r\n            // canvas.ctx.fillStyle = this.coorSettings.fillColorDim;\r\n            let n = (bounds[0] - pos.x) / unitVec.x;\r\n            return pos.add(unitVec.mult(n));\r\n         } else if (pos.x > bounds[1]) {\r\n            // canvas.ctx.fillStyle = this.coorSettings.fillColorDim;\r\n            let n = (bounds[1] - pos.x) / unitVec.x;\r\n            return pos.add(unitVec.mult(n));\r\n         } else {\r\n            // canvas.ctx.fillStyle = this.coorSettings.fillColor;\r\n            return pos;\r\n         }\r\n      } else {\r\n         /// if dimension is 'v' or even anything else.\r\n         let bounds = [10, this.gs.height - size.height - 10];\r\n         if (pos.y < bounds[0]) {\r\n            // canvas.ctx.fillStyle = this.coorSettings.fillColorDim;\r\n            let n = (bounds[0] - pos.y) / unitVec.y;\r\n            return pos.add(unitVec.mult(n));\r\n         } else if (pos.y > bounds[1]) {\r\n            // canvas.ctx.fillStyle = this.coorSettings.fillColorDim;\r\n            let n = (bounds[1] - pos.y) / unitVec.y;\r\n            return pos.add(unitVec.mult(n));\r\n         } else {\r\n            // canvas.ctx.fillStyle = this.coorSettings.fillColor;\r\n            return pos;\r\n         }\r\n      }\r\n   }\r\n\r\n}","import GraphSettings from './GraphSetting/GraphSettings.js';\r\nimport Coordinates from './Coordinates.js';\r\nimport Canvas from './Canvas.js';\r\nimport { Xfunction, EvalExpr, Point, Constant, Empty, Slider, Func } from './GraphChildren/index.js';\r\nexport default class Sketch {\r\n\r\n    constructor(canvasParent) {\r\n        this.canvas = new Canvas({ parent: canvasParent, attributes: { id: 'canvas' } });\r\n        this.childrenCanvas = new Canvas({ parent: canvasParent, attributes: { id: 'children-canvas' } });\r\n        this.gs = new GraphSettings(this, this.canvas.width, this.canvas.height);\r\n        // childrenTrans = this.gs.transform.getTransform();\r\n        // this.gs.transform.handlers.onchange = () => {\r\n        //     let { a, b, c, d, e, f } = this.gs.transform.getTransform();\r\n        //     a = a - childrenTrans.a; b = b - childrenTrans.b;\r\n        //     c = c - childrenTrans.c; d = d - childrenTrans.d;\r\n        //     e = e - childrenTrans.e; f = f - childrenTrans.f;\r\n        //     this.childrenCanvas.setTransform(a, b, c, d, e, f);\r\n        // };\r\n        this.coor = new Coordinates(this.gs);\r\n        this.children = new Map();\r\n        this.scriptParser = new MagicalParser.CustomParsers.Math();\r\n\r\n        this.childrenCanvas.ctx.miterLimit = 1;\r\n\r\n        // this.updator = { worker: new Worker('./updateChildren.js'), data: { status: 'ready' } };\r\n    }\r\n\r\n    childFromScript(script, propsTOset = {}) {\r\n        let parsedString = this.getChildParser.parse(script.replace(/\\^/g, '**'));\r\n        return childFromParsed(parsedString, propsTOset);\r\n    }\r\n\r\n    childFromParsed(parsedString, propsTOset = {}) {\r\n        propsTOset.sketch = this;\r\n        if (parsedString.type === '') {\r\n            return new Empty(propsTOset);\r\n        }\r\n        if (parsedString.name === '=') {\r\n            let left = parsedString.args[0], right = parsedString.args[1];\r\n\r\n            if (left.check({ type: 'variable', name: 'y' }) && !right.contains({ type: 'variable', name: 'y' })) {\r\n                return new Xfunction(Object.assign(propsTOset, { expr: right, }));\r\n            }\r\n\r\n            //such : area( h , b , theta ) = 0.5 * h * b * sin( theta )\r\n            //such : g(a) = a^2\r\n            else if (left.check({ type: 'functionCalling' })) {\r\n                // such : f(x) = x^2\r\n                if (left.args.length == 1 && left.args[0].check({ type: 'variable', name: 'x' }) && !right.contains({ type: 'variable', name: 'y' })) {\r\n                    return new Xfunction({ sketch: this, expr: right, id: left.name });\r\n                }\r\n\r\n                //such : area( h , b , theta) = 0.5 * h * b * sin( theta )\r\n                else {\r\n                    let params = [];\r\n                    let skip;\r\n                    if (left.args[0].check({ type: 'separator', name: ',' })) {\r\n                        for (let param of left.args[0].args) {\r\n                            if (param.type === 'variable') {\r\n                                params.push(param.name);\r\n                            } else {\r\n                                skip = true;\r\n                                continue;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (left.args[0].type !== 'variable') skip = true;\r\n                        if (!skip) params.push(left.args[0].name);\r\n                    }\r\n                    if (!skip) {\r\n                        return new Func(Object.assign(propsTOset, { id: left.name, params, expr: right }));\r\n                    }\r\n                }\r\n            }\r\n\r\n            //such : a = 2\r\n            else if (left.type === 'variable' && right.type === 'number') {\r\n                return new Slider(Object.assign(propsTOset, { id: left.name, value: right.value }));\r\n            }\r\n            //such : a = -2\r\n            else if (left.type === 'variable' && right.check({ type: 'prefixOperator', name: '-' }) && right.args[0].type === 'number') {\r\n                return new Slider(Object.assign(propsTOset, { id: left.name, value: -right.args[0].value }));\r\n            }\r\n            //such : a = 2b+c\r\n            else if (left.type === 'variable') {\r\n                return new Constant(Object.assign(propsTOset, { id: left.name, value: right }));\r\n            }\r\n\r\n        }\r\n        // /// like 2+3*x = sin(y)^2\r\n        // else if ((IsBool(parsedString)) && (ContainsSymbol(parsedString, GraphSettings.sy_x) || ContainsSymbol(parsedString, GraphSettings.sy_y))) {\r\n        //    XYFunction f = new XYFunction(GraphSettings);\r\n        //    {\r\n        //       Expression = MathPackage.Transformer.GetNodeFromLoycNode(parsedString, GraphSettings.CalculationSettings);\r\n        //    };\r\n        //    if (selectName) {\r\n        //       if (enrollName) {\r\n        //          f.SetName(GraphSettings.selectName());\r\n        //       }\r\n        //       else {\r\n        //          f.Name = GraphSettings.selectName();\r\n        //       }\r\n        //    }\r\n        //    return f;\r\n        // }\r\n\r\n        /// to add function like : x^2\r\n        else if (parsedString.contains({ type: 'variable', name: 'x' })) {\r\n            return new Xfunction(Object.assign(propsTOset, { expr: parsedString, }));\r\n        }\r\n\r\n        /// to add a point like (1, 2)\r\n        else if (parsedString.check({ type: 'block', name: '()' }) && parsedString.args.length == 1 && parsedString.args[0].check({ type: 'separator', name: ',', length: 2 })) {\r\n            /// it is a parametricFunction\r\n            if (vars.contains('t')) {\r\n                //    let func = new ParametricFunc({\r\n                //       Parameter: \"t\",\r\n                //       Start: new MathPackage.Nodes.Constant(-10),\r\n                //       End: new MathPackage.Nodes.Constant(10),\r\n                //       x_Expression: MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[0], GraphSettings.CalculationSettings),\r\n                //       y_Expression: MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[1], GraphSettings.CalculationSettings),\r\n                //    });\r\n                //   ;\r\n                //    func.Step = null;\r\n                //    if (selectName) {\r\n                //       if (enrollName)\r\n                //          func.SetName(GraphSettings.selectName());\r\n                //       else\r\n                //          func.Name = GraphSettings.selectName();\r\n                //    }\r\n                //    return func;\r\n            }\r\n            /// it is a point\r\n            else {\r\n                return new Point(Object.assign({ x: parsedString.args[0].args[0], y: parsedString.args[0].args[1] }, propsTOset));\r\n            }\r\n        }\r\n\r\n        {\r\n            /*\r\n \r\n        else {\r\n            //#region \"Add PointsDependant\";\r\n            if (PDsTypes().Contains(parsedString.Target.Name.ToString())) {\r\n                PointsDependant pd = GetPD(parsedString, GraphSettings, selectName, enrollName);\r\n                if (pd != null) {\r\n                    return pd;\r\n                }\r\n            }\r\n            //#endregion\r\n            else if (parsedString.Target.Name.ToString() == \"Curve\") {\r\n                if (parsedString.Args.Count == 5) {\r\n                    // Checking for problems\r\n                    if (!parsedString.Args[0].IsId || !MathExpression(parsedString.Args[1]) || !MathExpression(parsedString.Args[2]) || !MathExpression(parsedString.Args[3]) || !MathExpression(parsedString.Args[4]))\r\n                        throw new Exception($\"the arguments is not valid.\\n{parsedString.ToString().Remove(0, parsedString.ToString().length - 1)}\");\r\n                    // Getting the object\r\n                    ParametricFunc func = new ParametricFunc(GraphSettings);\r\n                    {\r\n                        Parameter = parsedString.Args[0].Name.Name,\r\n                            Start = MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[1], GraphSettings.CalculationSettings),\r\n                            End = MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[2], GraphSettings.CalculationSettings),\r\n                            x_Expression = MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[3], GraphSettings.CalculationSettings),\r\n                            y_Expression = MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[4], GraphSettings.CalculationSettings),\r\n            };\r\n                    func.Step = null;\r\n                    if (selectName) {\r\n                        if (enrollName)\r\n                            func.SetName(GraphSettings.selectName());\r\n                        else\r\n                            func.Name = GraphSettings.selectName();\r\n                    }\r\n                    return func;\r\n                }\r\n                else if (parsedString.Args.Count == 6) {\r\n                    // Checking for problems\r\n                    if (!parsedString.Args[0].IsId || !MathExpression(parsedString.Args[1]) || !MathExpression(parsedString.Args[2]) || !MathExpression(parsedString.Args[3]) || !MathExpression(parsedString.Args[4]) || !MathExpression(parsedString.Args[5]))\r\n                        throw new Exception($\"the arguments is not valid.\\n{parsedString.ToString().Remove(0, parsedString.ToString().length - 1)}\");\r\n                    // Getting the object\r\n                    ParametricFunc func = new ParametricFunc(GraphSettings);\r\n                    {\r\n                        Parameter = parsedString.Args[0].Name.Name,\r\n                            Start = MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[1], GraphSettings.CalculationSettings),\r\n                            End = MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[2], GraphSettings.CalculationSettings),\r\n                            Step = MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[3], GraphSettings.CalculationSettings),\r\n                            x_Expression = MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[4], GraphSettings.CalculationSettings),\r\n                            y_Expression = MathPackage.Transformer.GetNodeFromLoycNode(parsedString.Args[5], GraphSettings.CalculationSettings),\r\n                        };\r\n                    if (selectName) {\r\n                        if (enrollName)\r\n                            func.SetName(GraphSettings.selectName());\r\n                        else\r\n                            func.Name = GraphSettings.selectName();\r\n                    }\r\n                    return func;\r\n                }\r\n            }\r\n        }\r\n \r\n    */\r\n        }\r\n\r\n        return new EvalExpr(Object.assign(propsTOset, { expr: parsedString, drawable: false }));\r\n    }\r\n\r\n    getChildById(id) {\r\n        // for (let index = 0; index < this.children.length; index++) {\r\n        //     if (this.children[index].id === id) return { child, index };\r\n        //     continue;\r\n        // }\r\n        return this.children.get(id);\r\n    }\r\n\r\n    update(draw = true, coors = true) {\r\n\r\n        // this.updator.worker.onmessage = (msg) => {\r\n        // };\r\n        // this.updator.worker.postMessage('update');\r\n\r\n        for (let child of this.children.values()) {\r\n            if (child) {\r\n                child.update();\r\n            }\r\n        }\r\n        if (draw) {\r\n            this.draw(coors);\r\n        }\r\n\r\n    }\r\n\r\n    draw(coors = true) {\r\n        if (coors) {\r\n            this.canvas.clear();\r\n            this.coor.draw(this.canvas);\r\n        }\r\n        // let vp = this.gs.viewport;\r\n        // this.childrenCanvas.clear(null, [vp.xmin, vp.ymin, vp.width, vp.height]);\r\n        this.childrenCanvas.clear();\r\n\r\n        for (let child of this.children.values()) {\r\n            if (child) {\r\n                child.draw(this.childrenCanvas);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n","\r\n//#region canvas events\r\nimport { subTools, mouse } from '../global.js';\r\n\r\nexport default function canvasEvents() {\r\n   \r\n   let mousepressed;\r\n   let lines = MathPackage.Lines;\r\n   let dragInterval;\r\n\r\n   let startTransFunc = (e) => {\r\n\r\n      mousepressed = true;\r\n\r\n      /// the mouse position\r\n      let canvasPos = getPosittion(canvas.elt);\r\n      if (e.type === 'mousedown') {\r\n         mouse.x = e.clientX - canvasPos.left;\r\n         mouse.y = e.clientY - canvasPos.top;\r\n      } else {\r\n         //touchstart\r\n         let touch = e.touches[0];\r\n         mouse.x = touch.clientX - canvasPos.left;\r\n         mouse.y = touch.clientY - canvasPos.top;\r\n      }\r\n\r\n      Object.assign(subTools, {\r\n         type: subTools.type,\r\n         mouse: new vector(mouse.x, mouse.y),\r\n         iVector: mySketch.gs.transform.iVector,\r\n         jVector: mySketch.gs.transform.jVector\r\n      });\r\n\r\n      if (subTools.type === 'move') {\r\n         // canvasParent.style.cursor = 'grabbing';\r\n         // canvasParent.style.cursor = '-webkit-grabbing';\r\n         mouse.prev = { x: mouse.x, y: mouse.y };\r\n         mouse.vel = { x: 0, y: 0 };\r\n         clearInterval(dragInterval);\r\n         // dragInterval = setInterval(() => {\r\n         //    // mouse.prevVel = mouse.vel;\r\n         //    mouse.vel = { x: mouse.x - mouse.prev.x, y: mouse.y - mouse.prev.y };\r\n         //    // mouse.acc = { x: mouse.vel.x - mouse.prevVel.x, y: mouse.vel.y - mouse.prevVel.y };\r\n         //    mouse.prev = { x: mouse.x, y: mouse.y };\r\n         // }, 20);\r\n      }\r\n      else if (subTools.type.search('axises') > -1) {\r\n         // canvasParent.style.cursor = 'grabbing';\r\n         // canvasParent.style.cursor = '-webkit-grabbing';\r\n         let xEq = lines.lineEquation(-mySketch.gs.transform.xAngle, mySketch.gs.center),\r\n            yEq = lines.lineEquation(-mySketch.gs.transform.yAngle, mySketch.gs.center);\r\n         let d = 30;\r\n         let distTo = {\r\n            x: lines.distToLine(subTools.mouse, xEq),\r\n            y: lines.distToLine(subTools.mouse, yEq)\r\n         };\r\n         if (distTo.x < d && distTo.y < d) {\r\n            subTools.axis = 'xy';\r\n            subTools.xSpace = mySketch.gs.transform.xSapce;\r\n            subTools.ySpace = mySketch.gs.transform.ySapce;\r\n            subTools.xAngle = mySketch.gs.transform.xAngle;\r\n            subTools.yAngle = mySketch.gs.transform.yAngle;\r\n            subTools.transformOrigin = new vector(mySketch.gs.center.x, mySketch.gs.center.y);\r\n            subTools.xPenColor = Object.assign(new drawing.color(), mySketch.coor.coorSettings.penXaxis.color);\r\n            subTools.yPenColor = Object.assign(new drawing.color(), mySketch.coor.coorSettings.penYaxis.color);\r\n            mySketch.coor.coorSettings.penXaxis.color = new drawing.color(255, 0, 0, 155);\r\n            mySketch.coor.coorSettings.penYaxis.color = new drawing.color(255, 0, 0, 155);\r\n         }\r\n         else if (distTo.x < d) {\r\n            subTools.axis = 'x';\r\n            subTools.space = mySketch.gs.transform.xSapce;\r\n            subTools.angle = mySketch.gs.transform.xAngle;\r\n            let o = new vector(math.constrain(mySketch.gs.center.x, 0, mySketch.gs.width), math.constrain(mySketch.gs.center.y, 0, mySketch.gs.height));\r\n            if (o.x !== mySketch.gs.center.x) {\r\n               o = subTools.mouse;\r\n            }\r\n            subTools.transformOrigin = o;\r\n            subTools.penColor = [mySketch.coor.coorSettings.penXaxis.color].slice()[0];\r\n            mySketch.coor.coorSettings.penXaxis.color = new drawing.color(255, 0, 0, 155);\r\n         }\r\n         else if (distTo.y < d) {\r\n            subTools.axis = 'y';\r\n            subTools.space = mySketch.gs.transform.ySapce;\r\n            subTools.angle = mySketch.gs.transform.yAngle;\r\n            let o = new vector(math.constrain(mySketch.gs.center.x, 0, mySketch.gs.width), math.constrain(mySketch.gs.center.y, 0, mySketch.gs.height));\r\n            if (o.y !== mySketch.gs.center.y) {\r\n               o = subTools.mouse;\r\n            }\r\n            subTools.transformOrigin = o;\r\n            subTools.penColor = [mySketch.coor.coorSettings.penYaxis.color].slice()[0];\r\n            mySketch.coor.coorSettings.penYaxis.color = new drawing.color(255, 0, 0, 155);\r\n         }\r\n         else {\r\n            subTools.axis = undefined;\r\n         }\r\n         subTools.increment = 0;\r\n         mySketch.draw();\r\n      } else if (subTools.type === 'zoom') {\r\n         // canvasParent.style.cursor = 'grabbing';\r\n         /// setting the layer of zoomBox\r\n         let boxElt = document.createElement('div');\r\n         boxElt.classList.add('zoom-box');\r\n         // boxElt.setAttribute('style', `--top: 0;--left: 0;--width: 0;--height: 0;`);\r\n         canvasParent.append(boxElt);\r\n         subTools.boxElt = boxElt;\r\n         subTools.pxViewport = {};\r\n      }\r\n      e.preventDefault();\r\n   };\r\n\r\n   canvasParent.addEventListener('mousedown', startTransFunc);\r\n   canvasParent.addEventListener('touchstart', startTransFunc);\r\n\r\n   let updateTransFunc = (e) => {\r\n      //#region getting positions of mouse\r\n      \r\n      if (mousepressed) {\r\n\r\n         let canvasPos = getPosittion(canvas.elt);\r\n         if (e.type === 'mousemove') {\r\n            mouse.x = e.clientX - canvasPos.left;\r\n            mouse.y = e.clientY - canvasPos.top;\r\n         } else {\r\n            //touchstart\r\n            let touch = e.touches[0];\r\n            mouse.x = touch.clientX - canvasPos.left;\r\n            mouse.y = touch.clientY - canvasPos.top;\r\n         }\r\n\r\n         switch (subTools.type) {\r\n            case 'move':\r\n               {\r\n                  moveCoor(e);\r\n                  break;\r\n               }\r\n            case 'scale-axises':\r\n               {\r\n                  scaleAxises(e);\r\n                  break;\r\n               }\r\n            case 'rotate-axises':\r\n               {\r\n                  rotateAxises(e);\r\n                  break;\r\n               }\r\n            case 'zoom':\r\n               {\r\n                  zoomBox(e);\r\n                  break;\r\n               }\r\n         }\r\n         e.preventDefault();\r\n      }\r\n   };\r\n\r\n   window.addEventListener('mousemove', updateTransFunc, true);\r\n   window.addEventListener('touchmove', updateTransFunc, { passive: false, capture: true });\r\n\r\n   function getPosittion(elt) {\r\n      let parentPos = { left: 0, top: 0 };\r\n      if (elt.offsetParent) {\r\n         parentPos = getPosittion(elt.offsetParent);\r\n      }\r\n      return { left: elt.offsetLeft + parentPos.left, top: elt.offsetTop + parentPos.top };\r\n   }\r\n\r\n   let transEndFunc = (e) => {\r\n      if (mousepressed) {\r\n         mousepressed = false;\r\n         if (subTools.type === 'move') {\r\n            // canvasParent.style.cursor = 'grab';\r\n            // canvasParent.style.cursor = '-webkit-grab';\r\n            clearInterval(dragInterval);\r\n            mouse.vel = new vector(mouse.vel.x, mouse.vel.y);\r\n            while (mouse.vel.mag > 50) {\r\n               mouse.vel = mouse.vel.mult(0.9);\r\n            }\r\n            dragInterval = setInterval(() => {\r\n               if (mouse.vel.mag > 1) {\r\n                  mouse.vel = mouse.vel.mult(0.9);\r\n               }\r\n               mySketch.gs.transform.translate(mouse.vel);\r\n               mySketch.update();\r\n               if (mouse.vel.mag <= 1) clearInterval(dragInterval);\r\n            }, 10);\r\n         }\r\n         else if (subTools.type.search('axises') > -1) {\r\n            // canvasParent.style.cursor = 'grab';\r\n            // canvasParent.style.cursor = '-webkit-grab';\r\n            if (subTools.axis == 'x') {\r\n               mySketch.coor.coorSettings.penXaxis.color = subTools.penColor;\r\n            } else if (subTools.axis == 'y') {\r\n               mySketch.coor.coorSettings.penYaxis.color = subTools.penColor;\r\n            } else if (subTools.axis == 'xy') {\r\n               mySketch.coor.coorSettings.penXaxis.color = subTools.xPenColor;\r\n               mySketch.coor.coorSettings.penYaxis.color = subTools.yPenColor;\r\n            }\r\n            mySketch.draw();\r\n         }\r\n         else if (subTools.type === 'zoom') {\r\n            subTools.boxElt.remove();\r\n            if (subTools.pxViewport.width && subTools.pxViewport.height) {\r\n               mySketch.gs.transform.transformOrigin = undefined;\r\n               mySketch.gs.transform.setViewport(mySketch.gs.transform.getViewport(subTools.pxViewport));\r\n            }\r\n            showTransDetails([\r\n               'x: {',\r\n               `  xmin: ${mySketch.gs.viewport.xmin},`,\r\n               `  xmax: ${mySketch.gs.viewport.xmax}`,\r\n               '},',\r\n               'y: {',\r\n               `  ymin: ${mySketch.gs.viewport.ymin},`,\r\n               `  ymax: ${mySketch.gs.viewport.ymax}`,\r\n               '}',\r\n            ], 'zoom');\r\n            mySketch.update();\r\n         }\r\n      }\r\n   };\r\n\r\n   window.addEventListener('mouseup', transEndFunc);\r\n   window.addEventListener('touchend', transEndFunc);\r\n\r\n   canvasParent.addEventListener('mousewheel', (e) => {\r\n      e.preventDefault();\r\n\r\n      let canvasPos = getPosittion(canvas.elt);\r\n      mouse.x = e.clientX - canvasPos.left;\r\n      mouse.y = e.clientY - canvasPos.top;\r\n\r\n      let center = mySketch.gs.center;\r\n      let mousePos = mouse;\r\n      if (MathPackage.Core.dist(mouse.x, mouse.y, center.x, center.y) < 30) {\r\n         mousePos = center;\r\n      }\r\n      if (e.wheelDelta > 0) {\r\n         mySketch.gs.transform.zoomIn(new vector(mousePos.x, mousePos.y));\r\n         mySketch.update();\r\n      } else {\r\n         mySketch.gs.transform.zoomOut(new vector(mousePos.x, mousePos.y));\r\n         mySketch.update();\r\n      }\r\n   });\r\n\r\n   //#region mouse move (tools'-subtools') functions\r\n\r\n   function moveCoor(e) {\r\n      mySketch.gs.transform.translate(new vector(mouse.x, mouse.y).subtract(subTools.mouse));\r\n      mySketch.update();\r\n      // canvas.ellipse(mouse.x, mouse.y, 5);\r\n      subTools.mouse = new vector(mouse.x, mouse.y);\r\n   }\r\n\r\n   function scaleAxises(e) {\r\n      if (subTools.axis == 'x') {\r\n         let rotatedMouse = subTools.mouse;\r\n         let xEq = lines.lineEquation(-mySketch.gs.transform.xAngle, mySketch.gs.center);\r\n         let incre = (math.dist(mouse.x, mouse.y, rotatedMouse.x, rotatedMouse.y) ** 2 - lines.distToLine(new vector(mouse.x, mouse.y), xEq) ** 2) ** 0.5;\r\n\r\n         mySketch.gs.transform.transformOrigin = undefined;\r\n         if (!isNaN(incre)) {\r\n            let mina = angles.minAngle(vector.fromAngle(-mySketch.gs.transform.xAngle), new vector(mouse.x, mouse.y).subtract(rotatedMouse));\r\n            let dir = mina < Math.PI / 2 ? 1 : (mina > Math.PI / 2 ? -1 : 0);\r\n\r\n            mySketch.gs.transform.transformOrigin = subTools.transformOrigin;\r\n            mySketch.gs.transform.xSpace += (incre * dir - subTools.increment);\r\n            mySketch.gs.transform.reformXspace();\r\n            subTools.increment = incre * dir;\r\n         }\r\n\r\n         mySketch.gs.transform.onchange(true);\r\n         mySketch.update();\r\n         // canvas.ellipse(rotatedMouse.x, rotatedMouse.y, 5);\r\n         // canvas.ellipse(mouse.x, mouse.y, 5);\r\n\r\n         showTransDetails([\r\n            `*${(mySketch.gs.iVector.mag / subTools.iVector.mag).toFixed(2)}`\r\n         ]);\r\n\r\n      } else if (subTools.axis == 'y') {\r\n         let rotatedMouse = subTools.mouse;\r\n         let yEq = lines.lineEquation(-mySketch.gs.transform.yAngle, mySketch.gs.center);\r\n         let incre = (math.dist(mouse.x, mouse.y, rotatedMouse.x, rotatedMouse.y) ** 2 - lines.distToLine(new vector(mouse.x, mouse.y), yEq) ** 2) ** 0.5;\r\n\r\n         mySketch.gs.transform.transformOrigin = undefined;\r\n         if (!isNaN(incre)) {\r\n            let mina = angles.minAngle(vector.fromAngle(-mySketch.gs.transform.yAngle), new vector(mouse.x, mouse.y).subtract(rotatedMouse));\r\n            let dir = mina < Math.PI / 2 ? 1 : (mina > Math.PI / 2 ? -1 : 0);\r\n\r\n            mySketch.gs.transform.transformOrigin = subTools.transformOrigin;\r\n            mySketch.gs.transform.ySpace += (incre * dir - subTools.increment);\r\n            mySketch.gs.transform.reformYspace();\r\n            subTools.increment = incre * dir;\r\n         }\r\n\r\n         mySketch.gs.transform.onchange(true);\r\n         mySketch.update();\r\n         // canvas.ellipse(rotatedMouse.x, rotatedMouse.y, 5);\r\n         // canvas.ellipse(mouse.x, mouse.y, 5);\r\n         showTransDetails([\r\n            `*${(mySketch.gs.jVector.mag / subTools.jVector.mag).toFixed(2)}`\r\n         ]);\r\n      }\r\n      else if (subTools.axis == 'xy') {\r\n         let midEq = lines.lineEquation(-(mySketch.gs.transform.yAngle + mySketch.gs.transform.xAngle) / 2, mySketch.gs.center);\r\n         let rotatedMouse = lines.projectionToLine(subTools.mouse, midEq); // rotatedMouse here is the modified start point which sets on the line between x and y axises \r\n\r\n         let incre = (math.dist(mouse.x, mouse.y, rotatedMouse.x, rotatedMouse.y) ** 2 - lines.distToLine(new vector(mouse.x, mouse.y), midEq) ** 2) ** 0.5; // pathagorean's method \r\n\r\n         mySketch.gs.transform.transformOrigin = undefined;\r\n         if (!isNaN(incre)) {\r\n            let mina = angles.minAngle(vector.fromAngle(-mySketch.gs.transform.yAngle), new vector(mouse.x, mouse.y).subtract(rotatedMouse));\r\n            let dir = mina < Math.PI / 2 ? 1 : (mina > Math.PI / 2 ? -1 : 0);\r\n\r\n            mySketch.gs.transform.transformOrigin = subTools.transformOrigin;\r\n            let ratio = (mySketch.gs.transform.ySpace + (incre * dir - subTools.increment)) / mySketch.gs.transform.ySpace;\r\n            ratio = math.constrain(ratio, 0.9, 1.1);\r\n            mySketch.gs.transform.ySpace *= ratio;\r\n            mySketch.gs.transform.xSpace *= ratio;\r\n            mySketch.gs.transform.reformYspace();\r\n            mySketch.gs.transform.reformXspace();\r\n            subTools.increment = incre * dir;\r\n         }\r\n\r\n         mySketch.gs.transform.onchange(true);\r\n         mySketch.update();\r\n         // canvas.ellipse(rotatedMouse.x, rotatedMouse.y, 5);\r\n         // canvas.ellipse(mouse.x, mouse.y, 5);\r\n         showTransDetails([\r\n            `*${(mySketch.gs.jVector.mag / subTools.jVector.mag).toFixed(2)}`\r\n         ]);\r\n      }\r\n   }\r\n\r\n   function rotateAxises(e) {\r\n      if (subTools.axis == 'x') {\r\n         if (math.dist(mySketch.gs.center.x, mySketch.gs.center.y, mouse.x, mouse.y) > 10) {\r\n            let rotatedMouse = subTools.mouse;\r\n            let rotationAngle = angles.angle(subTools.mouse.subtract(new vector(mySketch.gs.center.x, mySketch.gs.center.y)), new vector(mouse.x, mouse.y).subtract(new vector(mySketch.gs.center.x, mySketch.gs.center.y)));\r\n            rotationAngle = angles.constrainAngle(rotationAngle);\r\n            if (!isNaN(rotationAngle)) {\r\n               // mySketch.gs.transform.xAngle = snapAngle(subTools.angle - rotationAngle);\r\n               mySketch.gs.transform.xAngle = angles.snapAngle(subTools.angle - rotationAngle, [0, Math.PI]);\r\n               let center = mySketch.gs.center;\r\n               rotatedMouse = center.add(subTools.mouse.subtract(center).rotate(rotationAngle));\r\n            }\r\n\r\n            mySketch.gs.transform.transformOrigin = undefined;\r\n            mySketch.gs.transform.invokeOnchange = true;\r\n            mySketch.gs.transform.onchange();\r\n            mySketch.update();\r\n\r\n            // canvas.ellipse(rotatedMouse.x, rotatedMouse.y, 5);\r\n            // canvas.ellipse(mouse.x, mouse.y, 5);\r\n            showTransDetails([\r\n               `xAngle: ${angles.stringDegAngle(mySketch.gs.transform.xAngle.toFixed(2))}`,\r\n               `rotationAngle: ${angles.stringDegAngle(-rotationAngle)}`\r\n            ]);\r\n         }\r\n      } else if (subTools.axis == 'y') {\r\n         if (math.dist(mySketch.gs.center.x, mySketch.gs.center.y, mouse.x, mouse.y) > 10) {\r\n\r\n            let rotatedMouse = subTools.mouse;\r\n            let rotationAngle = angles.angle(subTools.mouse.subtract(new vector(mySketch.gs.center.x, mySketch.gs.center.y)), new vector(mouse.x, mouse.y).subtract(new vector(mySketch.gs.center.x, mySketch.gs.center.y)));\r\n            rotationAngle = angles.constrainAngle(rotationAngle);\r\n            if (!isNaN(rotationAngle)) {\r\n               mySketch.gs.transform.yAngle = angles.snapAngle(subTools.angle - rotationAngle, [Math.PI / 2, 3*Math.PI/2]);\r\n               let center = mySketch.gs.center;\r\n               rotatedMouse = center.add(subTools.mouse.subtract(center).rotate(rotationAngle));\r\n            }\r\n\r\n            mySketch.gs.transform.invokeOnchange = true;\r\n            mySketch.gs.transform.onchange();\r\n            mySketch.update();\r\n            // canvas.ellipse(rotatedMouse.x, rotatedMouse.y, 5);\r\n            // canvas.ellipse(mouse.x, mouse.y, 5);\r\n            showTransDetails([\r\n               `yAngle: ${angles.stringDegAngle(mySketch.gs.transform.yAngle.toFixed(2))}`,\r\n               `rotationAngle: ${angles.stringDegAngle(-rotationAngle)}`\r\n            ]);\r\n         }\r\n      } else if (subTools.axis == 'xy') {\r\n         if (math.dist(mySketch.gs.center.x, mySketch.gs.center.y, mouse.x, mouse.y) > 10) {\r\n            let rotatedMouse = subTools.mouse;\r\n            let rotationAngle = angles.angle(subTools.mouse.subtract(new vector(mySketch.gs.center.x, mySketch.gs.center.y)), new vector(mouse.x, mouse.y).subtract(new vector(mySketch.gs.center.x, mySketch.gs.center.y)));\r\n            rotationAngle = angles.constrainAngle(rotationAngle);\r\n            if (!isNaN(rotationAngle)) {\r\n               mySketch.gs.transform.xAngle = subTools.xAngle - rotationAngle;\r\n               mySketch.gs.transform.yAngle = subTools.yAngle - rotationAngle;\r\n               let center = mySketch.gs.center;\r\n               rotatedMouse = center.add(subTools.mouse.subtract(center).rotate(rotationAngle));\r\n            }\r\n\r\n            mySketch.gs.transform.invokeOnchange = true;\r\n            mySketch.gs.transform.onchange();\r\n            mySketch.update();\r\n            // canvas.ellipse(rotatedMouse.x, rotatedMouse.y, 5);\r\n            // canvas.ellipse(mouse.x, mouse.y, 5);\r\n            showTransDetails([\r\n               `xAngle: ${angles.stringDegAngle(mySketch.gs.transform.xAngle)}`,\r\n               `yAngle: ${angles.stringDegAngle(mySketch.gs.transform.yAngle)}`,\r\n               `rotationAngle: ${angles.stringDegAngle(-rotationAngle)}`\r\n            ]);\r\n         }\r\n      }\r\n   }\r\n\r\n   function zoomBox(e) {\r\n\r\n      //#region calculating box\r\n      let s = { xmin: subTools.mouse.x, ymin: subTools.mouse.y, xmax: mouse.x, ymax: mouse.y };\r\n\r\n      subTools.pxViewport.xmin = Math.min(s.xmin, s.xmax); subTools.pxViewport.ymin = Math.min(s.ymin, s.ymax);\r\n      subTools.pxViewport.xmax = Math.max(s.xmin, s.xmax); subTools.pxViewport.ymax = Math.max(s.ymin, s.ymax);\r\n      subTools.pxViewport.width = subTools.pxViewport.xmax - subTools.pxViewport.xmin;\r\n      subTools.pxViewport.height = subTools.pxViewport.ymax - subTools.pxViewport.ymin;\r\n      s = subTools.pxViewport;\r\n      let slice;\r\n      if (s.width < 10 && s.height < 10) {\r\n         s.width = 0;\r\n         s.height = 0;\r\n      }\r\n      // reserved ratios\r\n      if (document.querySelector('#subtools-zoom-rr').checked || e.shiftKey) {\r\n         let a = angles.minAngle(vector.fromAngle(0), new vector(mySketch.gs.width, mySketch.gs.height));\r\n         let equ = lines.lineEquation(a, subTools.mouse);\r\n         let p = lines.projectionToLine(new vector(mouse.x, mouse.y), equ);\r\n         s = { xmin: subTools.mouse.x, ymin: subTools.mouse.y, xmax: Math.round(p.x), ymax: Math.round(p.y) };\r\n         subTools.pxViewport.xmin = Math.min(s.xmin, s.xmax); subTools.pxViewport.ymin = Math.min(s.ymin, s.ymax);\r\n         subTools.pxViewport.xmax = Math.max(s.xmin, s.xmax); subTools.pxViewport.ymax = Math.max(s.ymin, s.ymax);\r\n         subTools.pxViewport.width = subTools.pxViewport.xmax - subTools.pxViewport.xmin;\r\n         subTools.pxViewport.height = subTools.pxViewport.ymax - subTools.pxViewport.ymin;\r\n         s = subTools.pxViewport;\r\n      }\r\n      else {\r\n         subTools.boxElt.classList.remove('v');\r\n         subTools.boxElt.classList.remove('h');\r\n         if (s.height < 10 && s.width > 10) {\r\n            slice = { type: 'v' };\r\n            subTools.boxElt.classList.add('v');\r\n            s.ymin = 0;\r\n            s.ymax = mySketch.gs.height;\r\n            s.height = mySketch.gs.height;\r\n         }\r\n         else if (s.height > 10 && s.width < 10) {\r\n            slice = { type: 'h' };\r\n            subTools.boxElt.classList.add('h');\r\n            s.xmin = 0;\r\n            s.xmax = mySketch.gs.width;\r\n            s.width = mySketch.gs.width;\r\n         }\r\n      }\r\n      //#endregion\r\n\r\n      let fadeColor = mySketch.coor.coorSettings.background.isDark() ? '#fff5' : '#0005';\r\n      subTools.boxElt.setAttribute('style', `--left: ${s.xmin}px; --top: ${s.ymin}px; --width: ${s.width}px; --height: ${s.height}px; --background: ${fadeColor}`);\r\n\r\n   }\r\n\r\n   /**\r\n    * @param {Array} messeges ::: Array of string which will be converted into p html element\r\n    */\r\n   function showTransDetails(messeges) {\r\n      let html = '<div class=\"subtools-details\">';\r\n      for (let msg of messeges) {\r\n         html += '<p>' + msg + '</p>';\r\n      }\r\n      html += '</div>';\r\n      subTools.details.setContent(html);\r\n      subTools.details.show();\r\n   }\r\n\r\n   //#endregion\r\n\r\n}\r\n\r\n//#endregion\r\n\r\n","import canvasEvents from \"./canvasEvents.js\";\r\nimport toolsEvents from \"./toolsEvents.js\";\r\nimport ChildControl from \"../ChildControl.js\";\r\nimport { addControl, resize, keypadSettings, checkSM, sidebar } from \"../global.js\";\r\n\r\nexport default function setEvents () {\r\n   //#region window events\r\n   window.addEventListener('resize', resize);\r\n   window.addEventListener(\"mouseup\", function (event) {\r\n      //#region for backspace interval\r\n      if (keypadSettings.mouseDownForInterval) {\r\n         keypadSettings.mouseDownForInterval = false;\r\n         clearInterval(keypadSettings.backspaceInterval);\r\n      }\r\n      //#endregion\r\n      keypadSettings.hideKeyPad = true;\r\n   });\r\n   window.addEventListener(\"touchend\", function (event) {\r\n      //#region for backspace interval\r\n      if (keypadSettings.mouseDownForInterval) {\r\n         keypadSettings.mouseDownForInterval = false;\r\n         clearInterval(keypadSettings.backspaceInterval);\r\n      }\r\n      //#endregion\r\n      keypadSettings.hideKeyPad = true;\r\n   });\r\n   window.addEventListener('mousedown', function (e) {\r\n      //#region hide keybad\r\n      let keypadShown = /\\svisible\\s|^visible\\s|\\svisible$/.test(keypadSettings.showHideKeyBtn.className); // hasClass\r\n      if (keypadSettings.hideKeyPad && keypadShown) {\r\n         keypadSettings.showHideKeyBtn.click();\r\n      }\r\n      //#endregion\r\n   });\r\n   window.addEventListener('touchstart', function (e) {\r\n      //#region hide keybad\r\n      let keypadShown = /\\svisible\\s|^visible\\s|\\svisible$/.test(keypadSettings.showHideKeyBtn.className); // hasClass\r\n      if (keypadSettings.hideKeyPad && keypadShown) {\r\n         keypadSettings.showHideKeyBtn.click();\r\n      }\r\n      //#endregion\r\n   });\r\n   //#endregion\r\n\r\n   document.querySelector('#add-new-control').addEventListener('click', (e) => {\r\n      addControl(new ChildControl()); \r\n   });\r\n   \r\n   document.querySelector('#show-hide-sidebar').addEventListener('click',function (e) {\r\n      let $this = $(this);\r\n      let __visible = $this.hasClass(\"visible\");\r\n      let from = __visible ? \"visible\" : \"unvisible\",\r\n         to = __visible ? \"unvisible\" : \"visible\";\r\n     \r\n         // let path = this.querySelector('path');\r\n      if (__visible) {\r\n         document.body.querySelector('.app-container').appendChild(this);\r\n      } else {\r\n         sidebar.querySelector('.header').append(this);\r\n      }\r\n\r\n      $this.removeClass(from);\r\n      $this.addClass(to);\r\n\r\n      sidebar.classList.remove(from);\r\n      sidebar.classList.add(to);\r\n\r\n      resize();\r\n   });\r\n\r\n   canvasEvents();\r\n   toolsEvents();\r\n}","import { subTools } from '../global.js';\r\n\r\nexport default function toolsEvents() {\r\n\r\n   //#region zoom\r\n\r\n   let zoom = (direction) => {\r\n      var delay = 20;\r\n      setTimeout(() => {\r\n         if (direction == 'in') { mySketch.gs.transform.zoomIn(); mySketch.update(); } else { mySketch.gs.transform.zoomOut(); mySketch.update(); }\r\n         setTimeout(() => {\r\n            if (direction == 'in') { mySketch.gs.transform.zoomIn(); mySketch.update(); } else { mySketch.gs.transform.zoomOut(); mySketch.update(); }\r\n            setTimeout(() => {\r\n               if (direction == 'in') { mySketch.gs.transform.zoomIn(); mySketch.update(); } else { mySketch.gs.transform.zoomOut(); mySketch.update(); }\r\n               setTimeout(() => {\r\n                  if (direction == 'in') { mySketch.gs.transform.zoomIn(); mySketch.update(); } else { mySketch.gs.transform.zoomOut(); mySketch.update(); }\r\n                  setTimeout(() => {\r\n                     if (direction == 'in') { mySketch.gs.transform.zoomIn(); mySketch.update(); } else { mySketch.gs.transform.zoomOut(); mySketch.update(); }\r\n                     setTimeout(() => {\r\n                        if (direction == 'in') { mySketch.gs.transform.zoomIn(); mySketch.update(); } else { mySketch.gs.transform.zoomOut(); mySketch.update(); }\r\n                        setTimeout(() => {\r\n                           if (direction == 'in') { mySketch.gs.transform.zoomIn(); mySketch.update(); } else { mySketch.gs.transform.zoomOut(); mySketch.update(); }\r\n                           setTimeout(() => {\r\n                              if (direction == 'in') { mySketch.gs.transform.zoomIn(); mySketch.update(); } else { mySketch.gs.transform.zoomOut(); mySketch.update(); }\r\n                           }, delay);\r\n                        }, delay);\r\n                     }, delay);\r\n                  }, delay);\r\n               }, delay);\r\n            }, delay);\r\n         }, delay);\r\n      });\r\n   };\r\n\r\n   document.querySelector('#zoom-in-btn').addEventListener('click', () => {\r\n      zoom('in');\r\n   });\r\n\r\n   document.querySelector('#zoom-out-btn').addEventListener('click', () => {\r\n      zoom('out');\r\n   });\r\n\r\n   //#endregion tool - subtools events\r\n\r\n   let radios = document.querySelectorAll('.subtools-container input[type*=\"radio\"]');\r\n   radios.forEach(el => {\r\n      subTools.type = el.checked ? el.dataset.type : subTools.type;\r\n      el.addEventListener('change', () => {\r\n         subTools.type = el.checked ? el.dataset.type : subTools.type;\r\n      });\r\n   });\r\n\r\n   document.querySelector('#home').addEventListener('click', () => {\r\n      mySketch.gs.reset();\r\n      mySketch.update();\r\n   });\r\n\r\n   document.querySelector('#centrate').addEventListener('click', () => {\r\n      mySketch.gs.centrate();\r\n      mySketch.update();\r\n   });\r\n\r\n} ","import keypadEvents from './events.js';\r\nimport { keypadSettings, resize, checkSM, sidebar } from '../global.js';\r\n\r\nexport default function setupKeypad() {\r\n\r\n   keypadSettings.showHideKeyBtn.addEventListener(\"click\", function (e) {\r\n      let sidebarShown = /\\svisible\\s|^visible\\s|\\svisible$/.test(sidebar.className); // hasClass\r\n      if (!sidebarShown) {\r\n         document.querySelector(\"#show-hide-sidebar\").click();\r\n      }\r\n      let parent = document.querySelector(\".keypad-container\");\r\n      let $this = $(this);\r\n      let __keypadShown = $this.hasClass(\"visible\");\r\n      let from = __keypadShown ? \"visible\" : \"unvisible\",\r\n         to = __keypadShown ? \"unvisible\" : \"visible\";\r\n\r\n      keypadSettings.showHideKeyBtn.classList.remove(from);\r\n      keypadSettings.showHideKeyBtn.classList.add(to);\r\n\r\n      parent.classList.remove(from);\r\n      parent.classList.add(to);\r\n      if (__keypadShown) {\r\n         document.body.querySelector('.app-container').appendChild(keypadSettings.showHideKeyBtn);\r\n      } else {\r\n         parent.insertBefore(keypadSettings.showHideKeyBtn, parent.firstElementChild);\r\n      }\r\n      if (checkSM.smallScreen) {\r\n         resize();\r\n      }\r\n\r\n      keypadSettings.focusedControl.focus();\r\n   });\r\n\r\n   SUI.tabs(document.body.querySelector('.keypad-container .tabs-1'));\r\n\r\n   keypadEvents();\r\n}\r\n","import { keypadSettings, addControl } from './../global.js';\r\nimport ChildControl from './../ChildControl.js';\r\n\r\nexport default function(){\r\n   //#region (keypad - showHideBtn) events\r\n   let keypad = $('.keypad-container'),\r\n      sh = $(keypadSettings.showHideKeyBtn);\r\n\r\n   keypad.bind('focusin', function () {\r\n         keypadSettings.mathField.focus();\r\n   });\r\n\r\n   $(document.body).delegate(\"[cancel-hiding-keypad]\", \"mousedown touchstart\", function (e) {\r\n      keypadSettings.hideKeyPad = false;\r\n   });\r\n\r\n   $('.control').delegate(\".main\", \"touchstart\", function (e) {\r\n      if (sh.hasClass(\"hide\")) {\r\n         sh.click();\r\n      }\r\n   });\r\n   //#endregion\r\n\r\n   //#region writing\r\n\r\n   $(\".keypad-container .rows button[mq-cmd]\").each(function (index) {\r\n      $(this).on('click', function () {\r\n         let $this = $(this);\r\n         if ($this.hasClass('double-shiftable')) {\r\n            keypadSettings.mathField.cmd($(' > div.active > span.active', $this).attr('mq-cmd'));\r\n         } else if ($this.hasClass('shiftable')) {\r\n            keypadSettings.mathField.cmd($(' > span.active', $this).attr('mq-cmd'));\r\n         } else {\r\n            keypadSettings.mathField.cmd(this.getAttribute('mq-cmd'));\r\n         }\r\n         keypadSettings.focusedControl.focus();\r\n      });\r\n   });\r\n\r\n   $(\".keypad-container .rows button[mq-write]\").each(function (index) {\r\n      $(this).on('click', function () {\r\n         let $this = $(this);\r\n         if ($this.hasClass('double-shiftable')) {\r\n            keypadSettings.mathField.write($(' > div.active > span.active', $this).attr('mq-write'));\r\n         } else if ($this.hasClass('shiftable')) {\r\n            keypadSettings.mathField.write($(' > span.active', $this).attr('mq-write'));\r\n         } else {\r\n            keypadSettings.mathField.write(this.getAttribute('mq-write'));\r\n         }\r\n         keypadSettings.focusedControl.focus();\r\n      });\r\n   });\r\n\r\n   $(\".keypad-container .rows button[mq-func]\").each(function (index) {\r\n      $(this).on(\"click\", function () {\r\n         let $this = $(this);\r\n         if ($this.hasClass(\"double-shiftable\")) {\r\n            keypadSettings.mathField.write($(\" > div.active > span.active\", $this).attr(\"mq-func\"));\r\n         } else if ($this.hasClass(\"shiftable\")) {\r\n            keypadSettings.mathField.write($(\" > span.active\", $this).attr(\"mq-func\"));\r\n         } else {\r\n            keypadSettings.mathField.write(this.getAttribute(\"mq-func\"));\r\n         }\r\n         keypadSettings.mathField.cmd(\"(\");\r\n         keypadSettings.focusedControl.focus();\r\n      });\r\n   });\r\n\r\n   $(\".space\").on(\"click\", function () {\r\n      keypadSettings.mathField.keystroke(\"Right\");\r\n   });\r\n\r\n   //keystrokes\r\n   $(\".backspace\").on(\"mousedown\", function () {\r\n      if (keypadSettings.mathField.latex() == '') {\r\n         keypadSettings.focusedControl.remove();\r\n      } else {\r\n         keypadSettings.mathField.keystroke(\"Backspace\");\r\n      }\r\n\r\n      //#region for keep backSpace on holing the button\r\n\r\n      keypadSettings.mouseDownForInterval = true;\r\n      setTimeout(function () {\r\n         if (keypadSettings.mouseDownForInterval) {\r\n            keypadSettings.backspaceInterval = setInterval(function () {\r\n               keypadSettings.mathField.keystroke(\"Backspace\");\r\n            }, 120);\r\n         }\r\n      }, 400);\r\n\r\n      //#endregion\r\n\r\n   });\r\n\r\n   //#endregion\r\n\r\n   //#region direction\r\n\r\n   $(\".go-left\").on(\"click\", function () {\r\n      keypadSettings.mathField.keystroke(\"Left\");\r\n   });\r\n\r\n   $(\".go-right\").on(\"click\", function () {\r\n      keypadSettings.mathField.keystroke(\"Right\");\r\n   });\r\n\r\n   $(\".go-up\").on(\"click\", function () {\r\n      keypadSettings.mathField.keystroke(\"Up\");\r\n   });\r\n\r\n   $(\".go-down\").on(\"click\", function () {\r\n      keypadSettings.mathField.keystroke(\"Down\");\r\n   });\r\n\r\n   $(\".enter\").on(\"click\", function () {\r\n      addControl(new ChildControl(), parseInt(keypadSettings.focusedControl.orderELT.textContent));\r\n   });\r\n\r\n   //#endregion\r\n\r\n   //#region shift - double-shift\r\n\r\n   var shift = $(\".shift\");\r\n   shift.on(\"click\", function () {\r\n      let $this = $(this);\r\n      let rows = $this.parents(\".rows\");\r\n      if ($this.hasClass(\"active\")) {\r\n         $this.removeClass(\"active\");\r\n         $this.addClass(\"lock\");\r\n         rows.removeClass(\"shift-active\");\r\n         rows.addClass(\"shift-lock\");\r\n      } else {\r\n         if ($this.hasClass(\"lock\")) {\r\n            let spans = $(\r\n               \".shiftable > span, .double-shiftable > div > span\",\r\n               rows\r\n            );\r\n            spans.toggleClass(\"active\");\r\n            $this.removeClass(\"lock\");\r\n            rows.removeClass(\"shift-lock\");\r\n         } else {\r\n            let spans = $(\r\n               \".shiftable > span, .double-shiftable > div > span\",\r\n               rows\r\n            );\r\n            spans.toggleClass(\"active\");\r\n            $this.addClass(\"active\");\r\n            rows.addClass(\"shift-active\");\r\n         }\r\n      }\r\n   });\r\n\r\n   // this for disabling shift if it is not .lock\r\n   $(\".keypad-container .rows button\")\r\n      .not('.shift, .double-shift')\r\n      .on(\"click\", function () {\r\n         let $this = $(this);\r\n         let rows = $this.parents(\".rows\");\r\n         if (rows.hasClass(\"shift-active\")) {\r\n            let shift = $(\"button.shift\", rows);\r\n            let spans = $(\".shiftable > span, .double-shiftable > div > span\", rows);\r\n            spans.toggleClass(\"active\");\r\n            shift.removeClass(\"active\");\r\n            rows.removeClass('shift-active');\r\n         }\r\n      });\r\n\r\n   var dShift = $(\".double-shift\");\r\n   dShift.on(\"click\", function () {\r\n      let $this = $(this);\r\n      let divs = $(\".double-shiftable > div\", $this.parents(\".rows\"));\r\n      divs.toggleClass(\"active\");\r\n      $this.toggleClass(\"active\");\r\n\r\n   });\r\n\r\n      //#endregion\r\n}","import { getContainment, updateObjsOrder, resize, checkSM, addControl, keypadSettings, sidebar } from './global.js';\r\nimport Sketch from '../PLOTTO/Sketch.js';\r\nimport drawing from '../PLOTTO/drawing/index.js';\r\nimport setEvents from './events/index.js';\r\nimport { default as setupKeypad} from './keypad/index.js';\r\nimport ChildControl from './ChildControl.js';\r\nimport { Constant } from '../PLOTTO/GraphChildren/index.js';\r\n/**\r\n * \"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\" reminder\r\n * app folder is associated with PLOTTO folder, both of them depends upon the other.\r\n */\r\nexport default function setupAPP(canvasParent) {\r\n  document.body.style.height = window.innerHeight + 'px';\r\n\r\n  window.MP = MathPackage;\r\n  window.angles = MP.Angles;\r\n  window.lines = MP.Lines;\r\n  window.math = MP.Core;\r\n  window.drawing = drawing;\r\n  window.vector = MP.entities.Vector;\r\n  window.MQ = MathQuill.getInterface(2);\r\n  MQ.config({\r\n    sumStartsWithNEquals: true,\r\n    supSubsRequireOperand: true,\r\n    // charsThatBreakOutOfSupSub: '+-=<>',\r\n    autoSubscriptNumerals: true,\r\n    autoCommands: 'pi theta sqrt abs floor ceil round random sum int prod',\r\n    // // autoOperatorNames: '',\r\n    maxDepth: 10,\r\n  });\r\n  window.mySketch = new Sketch(canvasParent);\r\n  window.canvas = mySketch.canvas;\r\n  window.canvasParent = canvasParent;\r\n\r\n  resize.prevSize = { width: 1000, height: 1000 }; /// the app is desined upon the large screen so this should be the default\r\n  checkSM();\r\n  resize.prevSize = { width: window.innerWidth, height: window.innerHeight };\r\n\r\n  let mathFields = $(\".math-field\");\r\n  for (let i = 0; i < mathFields.length; i++) {\r\n    MQ.StaticMath(mathFields[i]);\r\n  }\r\n\r\n  let addNewGCelt = $(`\r\n      <li class=\"control\">\r\n        <div class=\"side-status\" cancel-move>\r\n          <div class=\"order-container\">\r\n            <span class='order'>123</span>\r\n          </div>\r\n        </div>\r\n        <div class=\"main\" cancel-move cancel-hiding-keypad>\r\n         <div class=script-container><span type=\"text\" class=\"script\">NEW</span></div>\r\n        </div>\r\n        <div class=\"side-ctrl\">\r\n          <button class=\"closebtn-2 remove\" cancel-move><div class=\"inner\"></div></button>\r\n          <span class=\"move\">\r\n            <div>\r\n              <span>..</span>\r\n              <span>..</span>\r\n              <span>..</span>\r\n            </div>\r\n          </span>\r\n        </div>\r\n      </li>\r\n      `)[0];\r\n  document.body.querySelector('#add-new-control').append(addNewGCelt);\r\n\r\n  setEvents();\r\n  setupKeypad();\r\n\r\n  setupResizer();\r\n  setupSortable();\r\n\r\n  resize();\r\n  mySketch.gs.centrate();\r\n  mySketch.update();\r\n\r\n  console.log('%cPLOTTO', 'background: black; color: white; font: 50px consolas;');\r\n  console.log('%cWe are sciCave', 'color: blue; font: 25px consolas;');\r\n\r\n  addControl(new ChildControl());\r\n}\r\n\r\nfunction setupResizer(){\r\n\r\n  //#region sidebar-resizer\r\n\r\n  var sidebarResizer = sidebar.querySelector(\".resizer\");\r\n  let srDraggingConfig = {}; // sidebarResizerDraggingConfig\r\n\r\n  $(sidebarResizer).draggable({\r\n    axis: 'x',\r\n    containment: getContainment(sidebar),\r\n\r\n    start: (e) => {\r\n      sidebarResizer.classList.add('dragging');\r\n      srDraggingConfig.intialWidth = sidebar.clientWidth;\r\n      srDraggingConfig.intialOffset = e.pageX;\r\n      srDraggingConfig.cursor = document.body.style.cursor;\r\n      document.body.style.cursor = 'e-resize';\r\n    },\r\n\r\n    stop: () => {\r\n      sidebarResizer.classList.remove('dragging');\r\n      sidebar.style.flexBasis = sidebarResizer.style.left;\r\n      document.body.style.cursor = srDraggingConfig.cursor;\r\n    },\r\n\r\n    drag: () => {\r\n      sidebar.style.flexBasis = sidebarResizer.style.left;\r\n      resize(false);\r\n    }\r\n\r\n  });\r\n\r\n  //#endregion\r\n\r\n}\r\n\r\nfunction setupSortable(){\r\n\r\n  //#region sortable-sidebar\r\n\r\n  var outer_ccc = document.querySelector('.outer-controls');\r\n  var inner_ccc = outer_ccc.querySelector('.inner-controls');\r\n\r\n  let startSorting = true;\r\n  $(\".controls.sortable\").sortable({\r\n    axis: \"y\",\r\n    cancel: '.control [cancel-move]',\r\n\r\n    start: function (e, ui) {\r\n      startSorting = true;\r\n      outer_ccc.classList.add('sorting');\r\n      if (inner_ccc.clientHeight > outer_ccc.clientHeight) {\r\n        outer_ccc.style.overflowY = 'scroll';\r\n      }\r\n\r\n      ui.item[0].classList.add('dragging');\r\n      let id = ui.item[0].getAttribute('id');\r\n      for (let child in mySketch.children) {\r\n        if (child.id === id) {\r\n          child.focus();\r\n          continue;\r\n        }\r\n      }\r\n    },\r\n\r\n    stop: function (e, ui) {\r\n      if (startSorting) {\r\n        outer_ccc.classList.remove('sorting');\r\n        outer_ccc.style.overflowY = 'auto';\r\n        ui.item[0].classList.remove('dragging');\r\n      } else {\r\n        startSorting = false;\r\n      }\r\n    },\r\n\r\n    update: function () {\r\n      updateObjsOrder();\r\n    }\r\n\r\n  });\r\n  $(\".controls.sortable\").disableSelection();\r\n\r\n  //#endregion\r\n\r\n}\r\n\r\nsetupAPP(document.querySelector('#canvas-parent'));"],"names":["ExistBefore","Error","constructor","id","UndefError","undef","generateName","Date","now","randomNameNum","toString","mathFunc","log","x","base","Math","log10","ln","E","sec","cos","csc","sin","cot","tan","asec","acos","acsc","asin","acot","atan","sinh","exp","cosh","tanh","asinh","sqrt","acosh","atanh","sech","csch","coth","asech","acsch","acoth","fact","NaN","__fact","gcd","values","gcd_","abs","a","gcd2","i","length","b","lcm","product","pow","mod","Object","assign","vars","pi","PI","e","getJSfunction","input","params","usestrict","undefThrowError","result","MagicalParser","Node","MathPackage","Parser","parsedTOjsFunction","toLowerCase","maximaTOjsFunction","latexTOmaxima","value","funcs","func","GraphChild","options","callback","handlers","renderable","hasOwnProperty","sketch","gs","this","coorManager","children","set","_id","checkId","update","canvas","handlerArgs","_update","error","onupdate","draw","_draw","remove","_remove","delete","onremove","onerror","Canvas","elt","document","createElement","parent","appendChild","width","clientWidth","height","clientHeight","attributes","name","setAttribute","font","family","ctx","getContext","textBaseline","resize","names","props","p","clear","fillStyle","viewport","fillRect","clearRect","setFont","size","measureString","txt","measureText","_trans","trans","setTransform","transform","getTransform","lw","mag","lineWidth","line","x1","y1","x2","y2","moveTo","lineTo","ellipse","y","radius1","radius2","rotation","startAngle","endAngle","counterClockWise","beginPath","fill","stroke","color","r","g","num","num2","num3","num4","num5","num7","num6","isDark","brightness","toArray","override","join","colorPackage","Core","random","c","randomColor","weight","style","setup","canvasORctx","strokeStyle","Xfunction","idExists","expr","propName","pen","coor","coorSettings","background","drawing","randomLightColor","randomDarkColor","me","expression","path","Path2D","str","replace","indexOf","previousP","midP","continous","xmin","xmax","drawingStep","coorTOpx","isNaN","sign","Point","regex","match","strokeWeight","splice","eval","EvalExpr","evalFunc","Constant","valueOf","setValue","handlerOptions","onchange","getValue","Func","Empty","Slider","ChildControl","graphChild","innerHTML","childNodes","status","mySketch","control","__updateElts","setEvents","newid","_graphChild","scriptELT","querySelector","removeELT","orderELT","mathField","MQ","MathField","edit","latex","enter","addEventListener","focus","blur","disableHandling","undefined","prev","parsedScript","scriptParser","parse","__getAll","type","map","removeElt","childFromParsed","__updateDependants","parsed","check","args","concat","forEach","gc","find","setScript","script","handle","focusTheField","keypadSettings","focusedControl","classList","add","blurTheField","index","parseInt","textContent","isError","querySelectorAll","v","click","f","addControl","undefVars","reduce","slice","undefFuncs","errorText","buttonsVars","buttonsFuncs","addVarsElt","$","bind","innerText","end","param","counter","String","fromCharCode","math","append","message","errorELT","hide","fadeOut","delay","fadeIn","console","removeGraphChild","alter","previousElementSibling","nextElementSibling","get","getAttribute","controls","newControlBtn","parentElement","childElementCount","setTimeout","removeControl","from","to","__toEmpty","__updateXfunction","__toXfunction","__updateEvalExpr","__toEvalExpr","__updateConstant","__toConstant","__updateSlider","__toSlider","sideStatus","valueType","attr","specialProps","valueElt","fraction","denominator","numerator","StaticMath","quotientRemainder","quotient","sliderOuter","slider","invokeOnchange","parseFloat","on","ismousedown","scmfs","min","max","step","updateSlider","angleMargin","angles","deg","zoomLimits","zoomRatio","reset","vector","fromAngle","xAngle","mult","xScale","yAngle","yScale","iVector","j","jVector","center","d","_transformOrigin","pxVector","pxTOcoor","coorVector","_xAngle","constrainAngle","minAngle","_yAngle","angle","dir","rotate","rotateX","rotateY","_center","vec","translate","zoomIn","centerOfZoom","transformOrigin","xZoomIn","yZoomIn","zoomOut","xZoomOut","yZoomOut","xSpace","reformXspace","ySpace","reformYspace","setViewport","keepRatio","ymin","ymax","xs","ys","isFinite","tfCorner","p_","getViewport","pxViewport","xStart","xTOcoor","xEnd","yStart","yTOcoor","yEnd","done","xZoomingState","ratio","xSpaceValue","yZoomingState","ySpaceValue","xSpaceModifier","ySpaceModifier","target","src","change","transToOrigin","ysm","xsm","invalid","isNumeric","lastVersion","vp","subtract","CoorManager","inverse","m","det","matrixInverse","ia","ib","ic","xToPixel","yToPixel","_width","_height","Transform","physicsRun","centrate","__id","has","defaultCoorSettings","xUnit","yUnit","drawDecimalLines","drawMainLines","drawAxisesLines","drawPolarCircles","drawPolarLines","drawPolarAngles","drawNumbers","decimalLinesSpace","polarCirclesSpace","polarLinesAnglesSpace","penDecimalLines","penMainLines","penXaxis","penYaxis","penPolarCircles","penPolarLines","autoRefiningOnZoomimg","antiBackground","fillColor","fillColorDim","custom","radian","start_x","start_y","end_x","end_y","floor","ceil","xD","yD","toExponential","toFixed","__getLabelPos","strokeText","fillText","pos","number","dimension","unitVec","bounds","n","Sketch","canvasParent","childrenCanvas","GraphSettings","Coordinates","Map","CustomParsers","miterLimit","childFromScript","propsTOset","parsedString","getChildParser","left","right","contains","skip","push","drawable","getChildById","coors","child","subTools","details","SUI","TempMessege","layer","toolsbar","onhoverFix","position","bottom","duration","content","mouse","backspaceInterval","mouseDownForInterval","showHideKeyBtn","sidebar","updateObjsOrder","objs","order","obj","autoFocus","insertBefore","setContainment","checkSM","appMainContainer","draggable","getContainment","prevSize","window","innerWidth","innerHeight","body","sidebarStyle","getComputedStyle","minWidth","maxWidth","canvasEvents","mousepressed","dragInterval","lines","Lines","startTransFunc","canvasPos","getPosittion","clientX","clientY","top","touch","touches","vel","clearInterval","search","xEq","lineEquation","yEq","distTo","distToLine","axis","xSapce","ySapce","xPenColor","yPenColor","space","o","constrain","penColor","increment","boxElt","preventDefault","updateTransFunc","rotatedMouse","incre","dist","mina","showTransDetails","midEq","projectionToLine","scaleAxises","rotationAngle","snapAngle","stringDegAngle","rotateAxises","s","checked","shiftKey","equ","round","fadeColor","zoomBox","parentPos","offsetParent","offsetLeft","offsetTop","passive","capture","transEndFunc","setInterval","messeges","html","msg","setContent","show","mousePos","wheelDelta","event","hideKeyPad","keypadShown","test","className","$this","__visible","hasClass","removeClass","addClass","zoom","direction","el","dataset","toolsEvents","setupKeypad","__keypadShown","firstElementChild","smallScreen","tabs","keypad","sh","delegate","each","cmd","write","keystroke","rows","parents","toggleClass","not","shift","keypadEvents","setupAPP","MP","Angles","entities","Vector","MathQuill","getInterface","config","sumStartsWithNEquals","supSubsRequireOperand","autoSubscriptNumerals","autoCommands","maxDepth","mathFields","addNewGCelt","sidebarResizer","srDraggingConfig","containment","start","intialWidth","intialOffset","pageX","cursor","stop","flexBasis","drag","setupResizer","outer_ccc","inner_ccc","startSorting","sortable","cancel","ui","overflowY","item","disableSelection","setupSortable"],"mappings":"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"}